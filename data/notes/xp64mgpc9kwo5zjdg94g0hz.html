<h1 id="tooling">Tooling<a aria-hidden="true" class="anchor-heading icon-link" href="#tooling"></a></h1>
<p><strong>Source:</strong> <a href="https://gitlab.laas.fr/gsaurel/talks">GitLab Repo 'Talks'</a></p>
<hr>
<!--
id: s2xc4iwmfsims2gvoxlr37k
title: Tooling
desc: ''
updated: 1664628178122
created: 1664628178122
subtitle: for Python & C++
theme: laas
author: Guilhem Saurel
mainfont: Source Serif 4
monofont: Source Code Pro
-->
<h2 id="this-presentation">This presentation<a aria-hidden="true" class="anchor-heading icon-link" href="#this-presentation"></a></h2>
<h3 id="available-at">Available at<a aria-hidden="true" class="anchor-heading icon-link" href="#available-at"></a></h3>
<p>\centering</p>
<p><a href="https://homepages.laas.fr/gsaurel/talks/tooling.pdf"><code>https://homepages.laas.fr/gsaurel/talks/ tooling.pdf</code></a></p>
<h3 id="under-license">Under License<a aria-hidden="true" class="anchor-heading icon-link" href="#under-license"></a></h3>
<p>\centering</p>
<p><img src="/UT3-AURO-2223-S10-Dendron/media/cc.png" alt="CC" style="">
<img src="/UT3-AURO-2223-S10-Dendron/media/by.png" alt="BY" style="">
<img src="/UT3-AURO-2223-S10-Dendron/media/sa.png" alt="SA" style=""></p>
<p><a href="https://creativecommons.org/licenses/by-sa/4.0/">https://creativecommons.org/licenses/by-sa/4.0/</a></p>
<h2 id="this-presentation-continued">This presentation (continued)<a aria-hidden="true" class="anchor-heading icon-link" href="#this-presentation-continued"></a></h2>
<h3 id="source">Source<a aria-hidden="true" class="anchor-heading icon-link" href="#source"></a></h3>
<p>\centering</p>
<p><a href="https://gitlab.laas.fr/gsaurel/talks/-/blob/main/tooling.md"><code>https://gitlab.laas.fr/gsaurel/talks : tooling.md</code></a></p>
<h3 id="discussions">Discussions<a aria-hidden="true" class="anchor-heading icon-link" href="#discussions"></a></h3>
<p>\centering</p>
<p>\url{<a href="https://im.laas.fr/%5C#/room/%5C#python-tooling:laas.fr%7D">https://im.laas.fr/\#/room/\#python-tooling:laas.fr}</a></p>
<h2 id="outline">Outline<a aria-hidden="true" class="anchor-heading icon-link" href="#outline"></a></h2>
<p>\tableofcontents</p>
<h1 id="motivation">Motivation<a aria-hidden="true" class="anchor-heading icon-link" href="#motivation"></a></h1>
<h2 id="write-readable-code">Write readable code<a aria-hidden="true" class="anchor-heading icon-link" href="#write-readable-code"></a></h2>
<blockquote>
<p>Code is read much more often than it is written</p>
</blockquote>
<p>\hfill --- Guido Van Rossum</p>
<p>. . .</p>
<ul>
<li>read → write</li>
<li>teamwork</li>
<li>future self</li>
</ul>
<h1 id="style">Style<a aria-hidden="true" class="anchor-heading icon-link" href="#style"></a></h1>
<h2 id="pep-8">PEP 8<a aria-hidden="true" class="anchor-heading icon-link" href="#pep-8"></a></h2>
<h3 id="style-guide-for-python-code">Style Guide for Python Code<a aria-hidden="true" class="anchor-heading icon-link" href="#style-guide-for-python-code"></a></h3>
<p><a href="https://peps.python.org/pep-0008/">https://peps.python.org/pep-0008/</a></p>
<ul>
<li>indentation: 4 spaces</li>
<li>maximum line length: 79</li>
<li>whitespaces</li>
<li>comments</li>
<li>naming</li>
</ul>
<h2 id="pep8--pycodestyle">pep8 → pycodestyle<a aria-hidden="true" class="anchor-heading icon-link" href="#pep8--pycodestyle"></a></h2>
<p><a href="https://github.com/PyCQA/pycodestyle">https://github.com/PyCQA/pycodestyle</a></p>
<p>. . .</p>
<pre><code>$ pycodestyle --first optparse.py
optparse.py:69:11: E401 multiple imports on one line
optparse.py:347:31: E211 whitespace before '('
optparse.py:357:17: E201 whitespace after '{'
optparse.py:472:29: E221 multiple spaces before operator
</code></pre>
<h2 id="flake8">flake8<a aria-hidden="true" class="anchor-heading icon-link" href="#flake8"></a></h2>
<p><a href="https://github.com/PyCQA/flake8">https://github.com/PyCQA/flake8</a></p>
<p>pycodestyle + pyflakes + mccabe</p>
<h2 id="clang-format">clang-format<a aria-hidden="true" class="anchor-heading icon-link" href="#clang-format"></a></h2>
<p><a href="https://clang.llvm.org/docs/ClangFormat.html">https://clang.llvm.org/docs/ClangFormat.html</a></p>
<pre class="language-bash"><code class="language-bash">$ clang-format -i QGVCore/QGVScene.cpp
</code></pre>
<pre class="language-diff"><code class="language-diff"><span class="token coord">@@ -173,14 +173,11 @@</span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  // Update items layout
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  foreach( QGVNode* node, _nodes ) {
</span><span class="token prefix deleted">-</span><span class="token line">    node->updateLayout();
</span><span class="token prefix deleted">-</span><span class="token line">  }
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  foreach (QGVNode *node, _nodes) node->updateLayout();
</span></span></code></pre>
<h2 id="yapf">yapf<a aria-hidden="true" class="anchor-heading icon-link" href="#yapf"></a></h2>
<p><a href="https://github.com/google/yapf">https://github.com/google/yapf</a></p>
<p>based on clang-format / gofmt, but for python</p>
<pre class="language-python"><code class="language-python">x <span class="token operator">=</span> <span class="token punctuation">{</span>  <span class="token string">'a'</span><span class="token punctuation">:</span><span class="token number">37</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">:</span><span class="token number">42</span><span class="token punctuation">,</span>

<span class="token string">'c'</span><span class="token punctuation">:</span><span class="token number">927</span><span class="token punctuation">}</span>
</code></pre>
<p>. . .</p>
<pre class="language-python"><code class="language-python">x <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">:</span> <span class="token number">927</span><span class="token punctuation">}</span>
</code></pre>
<h2 id="black">black<a aria-hidden="true" class="anchor-heading icon-link" href="#black"></a></h2>
<p><a href="https://github.com/psf/black">https://github.com/psf/black</a></p>
<p><img src="/UT3-AURO-2223-S10-Dendron/media/black.png" alt="black"></p>
<h2 id="black-main-caveat">black main caveat<a aria-hidden="true" class="anchor-heading icon-link" href="#black-main-caveat"></a></h2>
<pre class="language-python"><code class="language-python">super_long_line<span class="token punctuation">.</span>with_small_argument <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># some comment</span>
</code></pre>
<p>. . .</p>
<pre class="language-python"><code class="language-python">super_long_line<span class="token punctuation">.</span>with_small_argument <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">0</span>
<span class="token punctuation">]</span>  <span class="token comment"># some comment</span>
</code></pre>
<p>. . .</p>
<pre class="language-python"><code class="language-python"><span class="token comment"># some comment</span>
super_long_line<span class="token punctuation">.</span>with_small_argument <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</code></pre>
<h1 id="static-analysis">Static analysis<a aria-hidden="true" class="anchor-heading icon-link" href="#static-analysis"></a></h1>
<h2 id="mypy-motivation">Mypy: motivation<a aria-hidden="true" class="anchor-heading icon-link" href="#mypy-motivation"></a></h2>
<pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> b<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">int</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Performs addition on integers.

    >>> add(3, 4)
    7
    """</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token keyword">import</span> sys

    <span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<h2 id="mypy">Mypy<a aria-hidden="true" class="anchor-heading icon-link" href="#mypy"></a></h2>
<pre><code>$ python add.py 3 4
34
</code></pre>
<p>. . .</p>
<pre><code>$ mypy add.py
add.py:13: error: Argument 1 to "add" has incompatible
                  type "str"; expected "int"
add.py:13: error: Argument 2 to "add" has incompatible
                  type "str"; expected "int"
Found 2 errors in 1 file (checked 1 source file)
</code></pre>
<h2 id="pyupgrade">pyupgrade<a aria-hidden="true" class="anchor-heading icon-link" href="#pyupgrade"></a></h2>
<p><a href="https://github.com/asottile/pyupgrade">https://github.com/asottile/pyupgrade</a></p>
<pre class="language-diff"><code class="language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">class C(Base):
</span><span class="token prefix unchanged"> </span><span class="token line">    def f(self):
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">        super(C, self).f()
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        super().f()
</span></span></code></pre>
<p>. . .</p>
<p>For C++: <code>clang-tidy</code></p>
<h1 id="meta">Meta<a aria-hidden="true" class="anchor-heading icon-link" href="#meta"></a></h1>
<h2 id="editor--ide-integration">Editor / IDE integration<a aria-hidden="true" class="anchor-heading icon-link" href="#editor--ide-integration"></a></h2>
<p>Bring your own ;)</p>
<h2 id="pre-commit">pre-commit<a aria-hidden="true" class="anchor-heading icon-link" href="#pre-commit"></a></h2>
<p><a href="https://github.com/pre-commit/pre-commit">https://github.com/pre-commit/pre-commit</a></p>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">cat</span> .pre-commit-config.yaml
</code></pre>
<pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">repos</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span>   <span class="token key atrule">repo</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/psf/black
    <span class="token key atrule">rev</span><span class="token punctuation">:</span> 22.3.0
    <span class="token key atrule">hooks</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span>   <span class="token key atrule">id</span><span class="token punctuation">:</span> black
<span class="token punctuation">-</span>   <span class="token key atrule">repo</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/pre<span class="token punctuation">-</span>commit/mirrors<span class="token punctuation">-</span>clang<span class="token punctuation">-</span>format
    <span class="token key atrule">rev</span><span class="token punctuation">:</span> v14.0.3
    <span class="token key atrule">hooks</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span>   <span class="token key atrule">id</span><span class="token punctuation">:</span> clang<span class="token punctuation">-</span>format
        <span class="token key atrule">args</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">-</span>i<span class="token punctuation">,</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>style=Google<span class="token punctuation">]</span>
</code></pre>
<h2 id="pre-commit-usage">pre-commit usage<a aria-hidden="true" class="anchor-heading icon-link" href="#pre-commit-usage"></a></h2>
<pre><code>pre-commit run -a
</code></pre>
<p>. . .</p>
<pre><code>pre-commit install
</code></pre>
<h2 id="pre-commit-ci">pre-commit CI<a aria-hidden="true" class="anchor-heading icon-link" href="#pre-commit-ci"></a></h2>
<p><a href="https://pre-commit.ci/">https://pre-commit.ci/</a></p>
<h2 id="thats-all-folks-">That's all folks !<a aria-hidden="true" class="anchor-heading icon-link" href="#thats-all-folks-"></a></h2>
<p>Thanks for your time :)</p>