
> **Avertissement:**
Cette page peut contenir des fautes ! Envoyez-moi un message sur [`#UT3-AURO-M2-2223-Request:matrix.org`](https://matrix.to/#/#UT3-AURO-M2-2223-Request:matrix.org) si vous en trouvez, merci.

> Cours donné par N. Rivière

---

> Notes RKA du 2023/02/13 - Start




# Contraintes matérielles

- Quantité de calcul
- Discrétisation
- Problématiques Temps Réel: ordonnancement, priorités, ...
- Signaux: interfaces, ADC (Analog to Digital Converter), DAC (Digital to Analog Converter), PWM

# Système d'acquisition numérique

Il faut une fréquence $f$ deux fois supérieur à la fréquence max du signal analogique $f_{max}$.

# Schéma

![](/assets/images/B3.CCTR.CM.Implementation.BB20230213-01.png)

# Erreurs Possibles

## Quantification de la tension

Due à la longueur finie du mot de donnée en sortie de l'ADC.

## Précision

Déterminée par le nombre de bits de l'ADC.

## Erreur de quantification

Écart entre le signal analogique échantillonné et le signal numérique issu de la conversion.

La durée d'échantillonnage pendant laquelle le signal d'entrée est bloquéinhibe les changements de ce signal.

## Erreur sur un échantillon

$\pm\, x \; LSB$

(aussi possible quand les cables sont endommagés ou mal cablés)

# Reproduciton d'un signal

Lorsqu'on veut reproduire un signal échantillonné à $f_{ech} = 1600 Hz$:
![](/assets/images/B3.CCTR.CM.Implementation.BB20230213-02.png)
![](/assets/images/B3.CCTR.CM.Implementation.BB20230213-03.png)
![](/assets/images/B3.CCTR.CM.Implementation.BB20230213-04.png)

En Pratique, $f_{ech} = 10\times f$ pour avoir une reconstruction propre.

> Le choix d'un décalage de $100Hz$ pour $1500Hz$ permet d'avoir d'autre point que ceux sur l'abcisse.

$f_{max}$ déterminée par analyse du système (analyseur de spectre)

La précision voulue permet de choisir l'ADC.

# Gestion des mises en tension

Dans le cas d'un capteur non linéaire, privilégier un ADC à précision élevée.

![](/assets/images/B3.CCTR.CM.Implementation.BB20230213-05.png)
![](/assets/images/B3.CCTR.CM.Implementation.BB20230213-06.png)
![](/assets/images/B3.CCTR.CM.Implementation.BB20230213-07.png)

> Sortie DAC arduino due: $[0.55V,2.75V]$

# Ordonnancement

## Micro C167

### Échantillonnage

$f = 20\;MHz$

$T_{CPU} = \dfrac{1}{\;20\cdot 10^6\;} = 50\;ms$

Du coup on a $200\;ns$ d'attente à chaque début de séquence d'instructions.
![](/assets/images/B3.CCTR.CM.Implementation.BB20230213-08.png)

Si la fréquence du moteur est : $f_{moteur} = 1'000\; Hz\;$ alors
$$
f_{ech} = 10 \times f_{moteur} = 10\; kHz
$$

Temps de conversion **min** de l'ADC (sur une voix) est de $9.7\;\mu s$ donc le nombre de conversion AD/s est de $\dfrac{1}{\;9.7\cdot 10^{-6}\;} = 100'000$ écahantillons.

Temps de conversion **max** de l'ADC (sur une voix) est de $72.1\;\mu s$ donc le nombre de conversion AD/s est de $\dfrac{1}{\;72.1\cdot 10^{-6}\;} = 15'000$ écahantillons.

Donc le processeur tourne à $10'000'000$ d'instructions par seconde (soit $10\;Mips$)

![](/assets/images/B3.CCTR.CM.Implementation.BB20230213-09.png)

Il faudra caractérisé (mesurer) les bornes min et max pour le DAC.

Si $100\;Hz$ ne suffit pas on pourrait passer à $200\;Hz$ ce qui impliquerait que l'on divise par deux la fréquence d'échantillonnage à $5\;kHz$ ce qui continue de respecter le thm de shannon.

### Mise en oeuvre avec Timer et IRQ

![](/assets/images/B3.CCTR.CM.Implementation.BB20230213-10.png)



> Notes RKA du 2023/02/13 - End

---