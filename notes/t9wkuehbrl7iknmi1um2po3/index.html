<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/UT3-AURO-2223-S10-Dendron/favicon.ico"/><title>TP1 - RTOS/ESP-IDF</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Personal knowledge space"/><meta property="og:title" content="TP1 - RTOS/ESP-IDF"/><meta property="og:description" content="Personal knowledge space"/><meta property="og:url" content="https://tunnark.github.io/UT3-AURO-2223-S10-Dendron/notes/t9wkuehbrl7iknmi1um2po3/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="11/25/2022"/><meta property="article:modified_time" content="1/8/2023"/><link rel="canonical" href="https://tunnark.github.io/UT3-AURO-2223-S10-Dendron/notes/t9wkuehbrl7iknmi1um2po3/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/UT3-AURO-2223-S10-Dendron/_next/static/css/45335104db0800c4.css" as="style"/><link rel="stylesheet" href="/UT3-AURO-2223-S10-Dendron/_next/static/css/45335104db0800c4.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/UT3-AURO-2223-S10-Dendron/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/UT3-AURO-2223-S10-Dendron/_next/static/chunks/webpack-4b6d608acc70376a.js" defer=""></script><script src="/UT3-AURO-2223-S10-Dendron/_next/static/chunks/framework-28c999baf2863c3d.js" defer=""></script><script src="/UT3-AURO-2223-S10-Dendron/_next/static/chunks/main-cd4c7ef1c8acebbb.js" defer=""></script><script src="/UT3-AURO-2223-S10-Dendron/_next/static/chunks/pages/_app-163d89cf4f3e5ce8.js" defer=""></script><script src="/UT3-AURO-2223-S10-Dendron/_next/static/chunks/935-4dee79e80b8641c6.js" defer=""></script><script src="/UT3-AURO-2223-S10-Dendron/_next/static/chunks/6-50972def09142ee2.js" defer=""></script><script src="/UT3-AURO-2223-S10-Dendron/_next/static/chunks/pages/notes/%5Bid%5D-78d472fa3b924116.js" defer=""></script><script src="/UT3-AURO-2223-S10-Dendron/_next/static/zHaMehK8gqkJYPwoajrMO/_buildManifest.js" defer=""></script><script src="/UT3-AURO-2223-S10-Dendron/_next/static/zHaMehK8gqkJYPwoajrMO/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout" style="margin-top:64px;display:flex;flex-direction:row"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><main class="ant-layout-content side-layout-main" style="max-width:1200px;min-width:0;display:block"><div style="padding:0 24px"><div class="main-content" role="main"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="tp1---rtosesp-idf">TP1 - RTOS/ESP-IDF<a aria-hidden="true" class="anchor-heading icon-link" href="#tp1---rtosesp-idf"></a></h1>
<p>More information on the github repo: <a href="https://github.com/TunnARK/UT3-AURO-2223-S10-Coding/tree/master/SATR-TP1-ESPBank">SATR-TP1-ESPBank</a></p>
<h1 id="préparation-du-tp">Préparation du TP<a aria-hidden="true" class="anchor-heading icon-link" href="#préparation-du-tp"></a></h1>
<p>Se familiariser avec :</p>
<ul>
<li>
<p><a href="https://freertos.org/taskandcr.html">FreeRTOS - Tasks and Co-Routines</a></p>
<p>  --> API Reference > Task Creation</p>
<ul>
<li>vsStackDepth</li>
<li>vTaskDelay</li>
<li>xTaskCreate</li>
<li>vTaskSuspend</li>
</ul>
</li>
<li>
<p><a href="https://github.com/espressif/esp-idf/tree/master/examples">les exemples d'esp-idf</a></p>
</li>
</ul>
<h1 id="prérequisinstallations">Prérequis/Installations<a aria-hidden="true" class="anchor-heading icon-link" href="#prérequisinstallations"></a></h1>
<p>Installer ESP-IDF et suivre le <code>Get Started</code>:</p>
<ul>
<li><a href="/UT3-AURO-2223-S10-Dendron/github.com/espressif/esp-idf">Repo GitHub ESP-IDF</a></li>
<li><a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/get-started/linux-macos-setup.html">Docs - Get-Started: Manual Install (linux-macos)</a></li>
</ul>
<blockquote>
<p>Possibilité d'utiliser VS Code</p>
</blockquote>
<h1 id="slide">Slide<a aria-hidden="true" class="anchor-heading icon-link" href="#slide"></a></h1>
<p><img src="/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-01.png"></p>
<h2 id="this-presentation">This Presentation<a aria-hidden="true" class="anchor-heading icon-link" href="#this-presentation"></a></h2>
<p><img src="/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-02.png">
<img src="/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-03.png"></p>
<h2 id="freertos">FreeRTOS<a aria-hidden="true" class="anchor-heading icon-link" href="#freertos"></a></h2>
<p><img src="/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-04.png"></p>
<h2 id="esp-idf">ESP-IDF<a aria-hidden="true" class="anchor-heading icon-link" href="#esp-idf"></a></h2>
<p><img src="/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-05.png"></p>
<h2 id="hello-world">Hello World<a aria-hidden="true" class="anchor-heading icon-link" href="#hello-world"></a></h2>
<p><img src="/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-06.png"></p>
<h2 id="generic-gpio">Generic GPIO<a aria-hidden="true" class="anchor-heading icon-link" href="#generic-gpio"></a></h2>
<p><img src="/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-07.png"></p>
<h2 id="bank-server">Bank: Server<a aria-hidden="true" class="anchor-heading icon-link" href="#bank-server"></a></h2>
<p><img src="/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-08.png"></p>
<h2 id="bank-uart">Bank: UART<a aria-hidden="true" class="anchor-heading icon-link" href="#bank-uart"></a></h2>
<p><img src="/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-09.png"></p>
<h2 id="messages">Messages<a aria-hidden="true" class="anchor-heading icon-link" href="#messages"></a></h2>
<p><img src="/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-10.png"></p>
<h2 id="queues">Queues<a aria-hidden="true" class="anchor-heading icon-link" href="#queues"></a></h2>
<p><img src="/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-11.png"></p>
<h2 id="tasks">Tasks<a aria-hidden="true" class="anchor-heading icon-link" href="#tasks"></a></h2>
<p><img src="/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-12.png"></p>
<h2 id="rx-task">Rx Task<a aria-hidden="true" class="anchor-heading icon-link" href="#rx-task"></a></h2>
<p><img src="/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-13.png"></p>
<h2 id="bank-task">Bank Task<a aria-hidden="true" class="anchor-heading icon-link" href="#bank-task"></a></h2>
<p><img src="/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-14.png"></p>
<h2 id="tx-task">Tx Task<a aria-hidden="true" class="anchor-heading icon-link" href="#tx-task"></a></h2>
<p><img src="/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-15.png"></p>
<h2 id="client">Client<a aria-hidden="true" class="anchor-heading icon-link" href="#client"></a></h2>
<p><img src="/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-16.png"></p>
<h1 id="suppléments">Suppléments<a aria-hidden="true" class="anchor-heading icon-link" href="#suppléments"></a></h1>
<h2 id="code-c">Code C<a aria-hidden="true" class="anchor-heading icon-link" href="#code-c"></a></h2>
<blockquote>
<p>Pour de l'embarquer le RUST est plus robuste que le C</p>
</blockquote>
<p><a href="http://cliffle.com/blog/not-thread-safe/#the-bank-account-example">Le code à utiliser ici :</a></p>
<pre class="language-c++"><code class="language-c++">/*
 * Stores information about a bank account.
 */
struct bank_account {
    /* How much money is in the account. */
    int balance; /* never use floats for managing money (too much approximation) */
};

/*
 * Deposits 'amt' into the 'account' and returns the new balance.
 */
int deposit(struct bank_account *account, int amt) {
    account->balance += amt;
    return account->balance;
}

/*
 * Tries to withdraw 'amt' from the account. Returns 'true' if it
 * succeeded, 'false' if the account didn't contain enough.
 */
bool withdraw(struct bank_account *account, int amt) {
    if (account->balance >= amt) {
        account->balance -= amt;
        return true;
    } else {
        return false;
    }
}
</code></pre>
<p>Remarque:</p>
<ul>
<li>pour connaitre l'état du compte il suffit de faire <code>deposit(0)</code> est la fct retournera ce qui reste dans le compte</li>
</ul>
<h2 id="python">Python<a aria-hidden="true" class="anchor-heading icon-link" href="#python"></a></h2>
<pre class="language-python"><code class="language-Python"><span class="token keyword">def</span> <span class="token function">deposit</span><span class="token punctuation">(</span>amt <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">int</span>
<span class="token keyword">def</span> <span class="token function">withdraw</span><span class="token punctuation">(</span>amt <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">int</span>
</code></pre>
<h2 id="interruptions">Interruptions<a aria-hidden="true" class="anchor-heading icon-link" href="#interruptions"></a></h2>
<h3 id="gpio">GPIO<a aria-hidden="true" class="anchor-heading icon-link" href="#gpio"></a></h3>
<p>Le code de gestion des interruptions<code>~/esp/generic_gpio/main/gpio_example_main.c</code></p>
<pre class="language-c"><code class="language-C"><span class="token keyword">static</span> QueueHandle_t gpio_evt_queue <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">void</span> IRAM_ATTR <span class="token function">gpio_isr_handler</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span> arg<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name">uint32_t</span> gpio_num <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">uint32_t</span><span class="token punctuation">)</span> arg<span class="token punctuation">;</span>
    <span class="token function">xQueueSendFromISR</span><span class="token punctuation">(</span>gpio_evt_queue<span class="token punctuation">,</span> <span class="token operator">&#x26;</span>gpio_num<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">gpio_task_example</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span> arg<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name">uint32_t</span> io_num<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">xQueueReceive</span><span class="token punctuation">(</span>gpio_evt_queue<span class="token punctuation">,</span> <span class="token operator">&#x26;</span>io_num<span class="token punctuation">,</span> portMAX_DELAY<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"GPIO[%"</span>PRIu32<span class="token string">"] intr, val: %d\n"</span><span class="token punctuation">,</span> io_num<span class="token punctuation">,</span> <span class="token function">gpio_get_level</span><span class="token punctuation">(</span>io_num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="uart---universal-asynchronus-receivertransmitter">UART - Universal Asynchronus Receiver/Transmitter<a aria-hidden="true" class="anchor-heading icon-link" href="#uart---universal-asynchronus-receivertransmitter"></a></h2>
<ul>
<li><a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/peripherals/uart.html">lien vers la doc UART</a></li>
<li>Un UART n'est pas un bus temps réel
buffer entre le code et les files om gere pas ca</li>
<li>Chaque UART a sa propre horloge (dans le cas d'un USRT (synchronus) on rajoute une clock de référence)</li>
<li>equivalence reseau: 2eme couche du modele OSI donc similaire a une tram avec son protocle</li>
</ul>
<!--8 data graph-->
<!-- ![](/assets/images/B2.SATR.TP1.RTOSESPIDF.NotesGEA-01.png) -->
<!-- ![](/assets/images/B2.SATR.TP1.RTOSESPIDF.NotesGEA-02.png) -->
<!-- ![](/assets/images/B2.SATR.TP1.RTOSESPIDF.NotesGEA-03.png) -->
<p>ATTETNION: </p>
<ul>
<li>le pc est en 64 bit mais l'ESP32 est sur du 32 bit donc la taille d'un <code>int</code> n'est pas la meme</li>
<li>cepedant avec un <code>int</code> en 32 bit on peut gérer jusqu'à 40 millions d'euros i.e. <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>2</mn><mo>∗</mo><mn>32</mn><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>100</mn><mo>=</mo><mn>42</mn><mtext>  </mtext><mi>m</mi><mi>i</mi><mi>l</mi><mi>l</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">(2*32-1)/100=42\;millions</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">32</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">/100</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord">42</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">mi</span><span class="mord mathnormal" style="margin-right:0.01968em;">ll</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal">s</span></span></span></span></span></li>
</ul>
<h3 id="messages-1">Messages<a aria-hidden="true" class="anchor-heading icon-link" href="#messages-1"></a></h3>
<p>Ces messages devront prendre en compte :</p>
<ul>
<li>Header: [OxCA,OxFE,OxCA,OxFE]</li>
<li>type: REQ/REP</li>
<li>Client ID</li>
<li>Req ID</li>
<li>Operation</li>
<li>Ammount (32 bit int)</li>
</ul>
<p>Exemple:</p>
<ul>
<li>1 client et 1 serveur pour le moment</li>
<li>le client fait une requete:
<ul>
<li><code>M1(type=REQ, CID=1, RID=1, Amount=100, Op=1)</code></li>
</ul>
</li>
<li>Il recoit alors la réponse:
<ul>
<li><code>M1(type=REP, CID=1, RID=1, Amount=200, Op=1)</code></li>
</ul>
</li>
<li>On remarque alors qu'il peut y avoir un probleme avec ce jeu de parametres car on ne sait pas comment gérer l'absence et l'attente de réponse --> introduire du coup un param <code>time out</code> de 1 sec</li>
<li>Autre soucis c'est la synchronisation des canaux --> ajouter un <code>HEADER</code>
<ul>
<li>une autre option aurait été de faire un <code>3handshake</code> (soit <code>Sync>Sync/Ack>Ack</code>)</li>
</ul>
</li>
<li>Du coup on reprend l'échange précédant avec le header, on envoit dans l'ordre :
<ol>
<li>4 oct(s): Header</li>
<li>1 oct(s): Type</li>
<li>1 oct(s): Client ID (ou mieux un <strong>numéro de port</strong> ! attention ceci est valide si il n'y a pas de bus commun entre les pc)</li>
<li>1 oct(s): Req ID 
<ul>
<li>ici peut etre 1 oct suffit pas mais en vrai avec 1 oct on doit avoir plus de 256 requetes non répondus en moins d'une seconde donc ça ira</li>
</ul>
</li>
<li>1 oct(s): Operation</li>
<li>4 oct(s): Amount</li>
</ol>
</li>
<li>Une autre organisation plus optimale niveau mémoire et temps d'envoi/recpetion (mais cela rend la programmation plus risquée lors de la conception du coup on va plustot préférencer l'option précédente)
<ol>
<li>4 oct(s): Header</li>
<li>1 oct(s): Type + Operation</li>
<li>1 oct(s): Client ID</li>
<li>1 oct(s): Req ID</li>
<li>4 oct(s): Amount</li>
</ol>
</li>
</ul>
<!-- Un exemple de séquence de message : -->
<!-- ![](/assets/images/B2.SATR.TP1.RTOSESPIDF.NotesGEA-04.png) -->
<ul>
<li>La configuration python avec <code>dep/withdraw/tx/rx</code> ne permettra pas d'envoyer plusieurs requetes en meme temps car les fcts <code>dep</code> et <code>with</code> appel <code>tx</code> et <code>rx</code> (si on a le temps on verra comment gerer de l'asynchrone en python)</li>
</ul>
<h3 id="files-dattentes">Files d'attentes<a aria-hidden="true" class="anchor-heading icon-link" href="#files-dattentes"></a></h3>
<p>On crée un pointeur contenant toute les files d'attentes (<code>Rx</code>,<code>Tx1</code>, <code>Tx2</code>, <code>Tx3</code>, ...).</p>
<p>Chaque files nécessite une capacité (nombre de requete qu'elle contient ici 10) et d'une taille pour chaque requete</p>
<pre class="language-c"><code class="language-C"><span class="token comment">//create a queue to handle gpio event from isr</span>
    gpio_evt_queue <span class="token operator">=</span> <span class="token function">xQueueCreate</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token class-name">uint32_t</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="priorités">Priorités<a aria-hidden="true" class="anchor-heading icon-link" href="#priorités"></a></h3>
<p>Maintenant quelles priorités données aux tâches, il y a 3 philosophies :</p>
<ul>
<li>Back Pressure: donner la prior. à Tx pour eviter des bottle neck</li>
<li>Conservative : donner la prior. à Rx pour ne pas perdre de donner</li>
<li>Fairly: donner la priorité à la tache la plus solicité ici bank puisque qu'il a 3 copie de Tx/Rx qui l'appelle</li>
</ul>
<h2 id="test-unitaire">Test Unitaire<a aria-hidden="true" class="anchor-heading icon-link" href="#test-unitaire"></a></h2>
<p>TDD - Test Driver Development</p>
<h1 id="compte-rendu-de-tp-du-20221130">Compte Rendu de TP du 2022/11/30<a aria-hidden="true" class="anchor-heading icon-link" href="#compte-rendu-de-tp-du-20221130"></a></h1>
<h2 id="hello-world-1">Hello World<a aria-hidden="true" class="anchor-heading icon-link" href="#hello-world-1"></a></h2>
<ol>
<li>Suivre le <a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/get-started/linux-macos-setup.html#">guide d'installation</a> jusqu'à l'étape <code>Configure Your Project</code> (etape exclue).</li>
<li>Ignorer cette étape, mais à la place modifier le fichier <code>/workspace/esp/hello_world/sdkconfig</code> pour reconfigurer la fréquence de <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>40</mn><mi>M</mi><mi>H</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">40MHz</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">40</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal" style="margin-right:0.04398em;">Hz</span></span></span></span></span> à <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>26</mn><mi>M</mi><mi>H</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">26MHz</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">26</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal" style="margin-right:0.04398em;">Hz</span></span></span></span></span> (cf slide 6 pour plus d'info).</li>
<li>Continuer les étapes restantes du <a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/get-started/linux-macos-setup.html#">guide d'installation</a>
<ul>
<li>Une fois le <code>Build Project</code> terminé, lancer le flash</li>
<li>Si vous recevez une erreur du style "port introuvalbe", s'assurer que la session utilisateur a acces au groupe
<ol>
<li><code>ll \dev\ttyUSB0</code> (ou <code>ll \dev\PORT</code>) pour connaitre les droits d'accès du port</li>
<li><code>sudo usermod -aG GROUP USERNAME</code> pour ajouter un user dans un groupe</li>
<li><code>groups</code> ne se met pas à jour directement (visuellement) donc faire <code>newgrp GROUP</code> pour mettre à jour le groupe et relancer <code>groups</code> pour lister les utilisateurs (vérifier que l'utilisateur ajouter et bien présent).</li>
</ol>
</li>
</ul>
</li>
</ol>
<h2 id="generic-gpio-1">Generic GPIO<a aria-hidden="true" class="anchor-heading icon-link" href="#generic-gpio-1"></a></h2>
<ol>
<li>Se placer dans le workspace (ici <code>/esp/</code>) et copier-coller le dossier exemple gpio <code>cp -r $IDF_PATH/examples/peripherals/gpio/generic_gpio .</code></li>
<li>Se placer dans <code>/workspace/generic_gpio</code> et lancer <code>idf.py set-target esp32</code></li>
<li>Modifier le fichier <code>/workspace/generic_gpio/sdkconfig</code> pour reconfigurer la fréquence de <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>40</mn><mi>M</mi><mi>H</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">40MHz</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">40</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal" style="margin-right:0.04398em;">Hz</span></span></span></span></span> à <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>26</mn><mi>M</mi><mi>H</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">26MHz</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">26</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal" style="margin-right:0.04398em;">Hz</span></span></span></span></span> (cf slide 7 pour plus d'info).</li>
<li>Lancer le build <code>idf.py build</code></li>
<li>Flasher la carte <code>idf.py flash</code> (ou <code>idf.py -p PORT flash</code>)</li>
<li>Le code est déjà en train de s'exécuter en background pour le voir lancer <code>idf.py monitor</code> (ou <code>idf.py -p PORT monitor</code>)</li>
<li>Se familiariser avec le code de communication <code>/workspace/generic_gpio/main/</code></li>
</ol>
<h1 id="compte-rendu-de-tp-du-20221209">Compte Rendu de TP du 2022/12/09<a aria-hidden="true" class="anchor-heading icon-link" href="#compte-rendu-de-tp-du-20221209"></a></h1>
<h2 id="sys-emb">Sys. Emb.<a aria-hidden="true" class="anchor-heading icon-link" href="#sys-emb"></a></h2>
<h3 id="liens-utiles">Liens utiles<a aria-hidden="true" class="anchor-heading icon-link" href="#liens-utiles"></a></h3>
<ul>
<li><a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/get-started/index.html#">Get Started</a></li>
<li><a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/peripherals/uart.html">Docs UART</a></li>
</ul>
<h3 id="booting">Booting<a aria-hidden="true" class="anchor-heading icon-link" href="#booting"></a></h3>
<ol>
<li>Se placer dans le workspace (ici <code>/esp/</code>) et copier-coller le dossier exemple gpio
<code>cp -r /esp/esp-idf/examples/peripherals/uart/uart_async_rxtxtasks/ .</code></li>
<li>Se placer dans <code>/workspace/uart_async_rxtxtasks</code> et lancer <code>idf.py set-target esp32</code></li>
<li>Modifier le fichier <code>/workspace/uart_async_rxtxtasks/sdkconfig</code> pour reconfigurer la fréquence de <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>40</mn><mi>M</mi><mi>H</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">40MHz</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">40</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal" style="margin-right:0.04398em;">Hz</span></span></span></span></span> à <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>26</mn><mi>M</mi><mi>H</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">26MHz</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">26</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal" style="margin-right:0.04398em;">Hz</span></span></span></span></span> (cf slide 7 pour plus d'info).</li>
<li>Lancer le build <code>idf.py build</code></li>
<li>Flasher la carte <code>idf.py flash</code> (ou <code>idf.py -p PORT flash</code>)</li>
<li>Le code est déjà en train de s'exécuter en background pour le voir lancer <code>idf.py monitor</code> (ou <code>idf.py -p PORT monitor</code>)</li>
</ol>
<h3 id="configuration-des-ports">Configuration des ports<a aria-hidden="true" class="anchor-heading icon-link" href="#configuration-des-ports"></a></h3>
<ol>
<li>Ouvrir le fichier <code>main/uart_async_rxtxtasks_main.c</code></li>
<li>Modifier les ports par défaut par :
<ul>
<li>
<pre class="language-c"><code class="language-C">  <span class="token comment">// Dans /main/uart_async_rxtxtasks_main.c</span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TXD_PIN</span> <span class="token expression"><span class="token punctuation">(</span>GPIO_NUM_1<span class="token punctuation">)</span></span></span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">RXD_PIN</span> <span class="token expression"><span class="token punctuation">(</span>GPIO_NUM_3<span class="token punctuation">)</span></span></span>
</code></pre>
</li>
</ul>
</li>
<li>De plus, remplacer dans ce code toute apparition de <code>UART_NUM_1</code> par <code>UART_NUM_0</code></li>
</ol>
<h3 id="codage">Codage<a aria-hidden="true" class="anchor-heading icon-link" href="#codage"></a></h3>
<h2 id="python-1">Python<a aria-hidden="true" class="anchor-heading icon-link" href="#python-1"></a></h2>
<h3 id="objectif">Objectif<a aria-hidden="true" class="anchor-heading icon-link" href="#objectif"></a></h3>
<p>Créer un code python pour instancier et visualiser les fonctionnalités du projet Bank</p>
<pre><code>- une fonciton `Création/Suppression` de compte bancaire
- une fonction `Deposit`
- une fonction `Withdraw`
</code></pre>
<h3 id="module-recommandé">Module recommandé<a aria-hidden="true" class="anchor-heading icon-link" href="#module-recommandé"></a></h3>
<p>Module <code>struct</code>, <code>bserial</code></p>
<h3 id="creation-dune-interface">Creation d'une interface<a aria-hidden="true" class="anchor-heading icon-link" href="#creation-dune-interface"></a></h3>
<p>Lien Utile: <a href="https://www.cours-gratuit.com/tutoriel-python/tutoriel-python-programmer-une-interface-graphique-avec-tkinter-partie-1#_Toc52998640">Interface Python avec Tkinter</a></p>
<h3 id="class-client">Class Client<a aria-hidden="true" class="anchor-heading icon-link" href="#class-client"></a></h3>
<ul>
<li>sur python le typage est dynamic donc le type est assigné selon ce qui arrive</li>
<li>le header n'est pas a mettre dans le struct.pack car il précéde le message</li>
</ul>
<h3 id="class-message">Class Message<a aria-hidden="true" class="anchor-heading icon-link" href="#class-message"></a></h3>
<p>class message</p>
<h1 id="testings-on-20230108">Testings on 2023/01/08<a aria-hidden="true" class="anchor-heading icon-link" href="#testings-on-20230108"></a></h1>
<h2 id="coding-on-esp32">Coding on ESP32<a aria-hidden="true" class="anchor-heading icon-link" href="#coding-on-esp32"></a></h2>
<h3 id="how-to-run-the-code">How to run the code<a aria-hidden="true" class="anchor-heading icon-link" href="#how-to-run-the-code"></a></h3>
<ol>
<li>Open New Terminal </li>
<li>Install Environment
<ul>
<li><code>cd /workspace/esp-idf/</code></li>
<li><code>./install.sh esp32</code></li>
<li><code>. ./export.sh</code></li>
</ul>
</li>
<li>Sett up UART Environment
<ul>
<li><code>cd /workspace/uart_async_rxtxtasks/</code></li>
<li><code>idf.py set-target esp32</code></li>
<li><code>idf.py build</code></li>
<li><code>idf.py -p /dev/ttyUSB0 flash</code> (check Port ID in <code>/dev/</code> before running the command)</li>
<li><code>idf.py -p /dev/ttyUSB0 monitor</code></li>
</ul>
</li>
</ol>
<h3 id="results">Results<a aria-hidden="true" class="anchor-heading icon-link" href="#results"></a></h3>
<p>Running <code>idf.py build</code> returns :</p>
<pre class="language-shell"><code class="language-shell">Executing action: all <span class="token punctuation">(</span>aliases: build<span class="token punctuation">)</span>
Running ninja <span class="token keyword">in</span> directory /home/tunn/esp/uart_async_rxtxtasks/build
Executing <span class="token string">"ninja all"</span><span class="token punctuation">..</span>.
<span class="token punctuation">[</span><span class="token number">1</span>/1<span class="token punctuation">]</span> <span class="token builtin class-name">cd</span> /home/tunn/esp/uart_async_rxtxtasks/build/bootloader/esp-idf/e<span class="token punctuation">..</span>.000 /home/tunn/esp/uart_async_rxtxtasks/build/bootloader/bootloader.binBootloader binary size 0x6720 bytes. 0x8e0 bytes <span class="token punctuation">(</span><span class="token number">8</span>%<span class="token punctuation">)</span> free.
<span class="token punctuation">[</span><span class="token number">2</span>/7<span class="token punctuation">]</span> Building C object esp-idf/main/CMakeFiles/__idf_main.dir/uart_async_rxtxtasks_main.c.obj/home/tunn/esp/uart_async_rxtxtasks/main/uart_async_rxtxtasks_main.c: In <span class="token keyword">function</span> <span class="token string">'tx_task'</span><span class="token builtin class-name">:</span>
/home/tunn/esp/uart_async_rxtxtasks/main/uart_async_rxtxtasks_main.c:98:19: warning: unused variable <span class="token string">'nb_transmit'</span> <span class="token punctuation">[</span>-Wunused-variable<span class="token punctuation">]</span>
   <span class="token number">98</span> <span class="token operator">|</span>         const int <span class="token assign-left variable">nb_transmit</span><span class="token operator">=</span>uart_write_bytes<span class="token punctuation">(</span>UART_NUM_0, transmit, sizeof<span class="token punctuation">(</span>transmit<span class="token punctuation">))</span><span class="token punctuation">;</span>
      <span class="token operator">|</span>                   ^~~~~~~~~~~
/home/tunn/esp/uart_async_rxtxtasks/main/uart_async_rxtxtasks_main.c:93:19: warning: unused variable <span class="token string">'nb_transmitH'</span> <span class="token punctuation">[</span>-Wunused-variable<span class="token punctuation">]</span>
   <span class="token number">93</span> <span class="token operator">|</span>         const int <span class="token assign-left variable">nb_transmitH</span><span class="token operator">=</span>uart_write_bytes<span class="token punctuation">(</span>UART_NUM_0, Header, sizeof<span class="token punctuation">(</span>Header<span class="token punctuation">))</span><span class="token punctuation">;</span>
      <span class="token operator">|</span>                   ^~~~~~~~~~~~
/home/tunn/esp/uart_async_rxtxtasks/main/uart_async_rxtxtasks_main.c: In <span class="token keyword">function</span> <span class="token string">'rx_task'</span><span class="token builtin class-name">:</span>
/home/tunn/esp/uart_async_rxtxtasks/main/uart_async_rxtxtasks_main.c:143:19: warning: unused variable <span class="token string">'nb_bitM'</span> <span class="token punctuation">[</span>-Wunused-variable<span class="token punctuation">]</span>
  <span class="token number">143</span> <span class="token operator">|</span>         const int <span class="token assign-left variable">nb_bitM</span><span class="token operator">=</span>uart_read_bytes<span class="token punctuation">(</span>UART_NUM_0, message, sizeof<span class="token punctuation">(</span>message_t<span class="token punctuation">)</span>, <span class="token number">1000</span> / portTICK_PERIOD_MS<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token operator">|</span>                   ^~~~~~~
/home/tunn/esp/uart_async_rxtxtasks/main/uart_async_rxtxtasks_main.c: In <span class="token keyword">function</span> <span class="token string">'bank_task'</span><span class="token builtin class-name">:</span>
/home/tunn/esp/uart_async_rxtxtasks/main/uart_async_rxtxtasks_main.c:156:9: warning: unused variable <span class="token string">'balance'</span> <span class="token punctuation">[</span>-Wunused-variable<span class="token punctuation">]</span>
  <span class="token number">156</span> <span class="token operator">|</span>     int balance<span class="token punctuation">;</span> //Solde <span class="token function">du</span> compte
      <span class="token operator">|</span>         ^~~~~~~
<span class="token punctuation">[</span><span class="token number">6</span>/7<span class="token punctuation">]</span> Generating binary image from built executableesptool.py v4.5.dev0
Creating esp32 image<span class="token punctuation">..</span>.
Merged <span class="token number">2</span> ELF sections
Successfully created esp32 image.
Generated /home/tunn/esp/uart_async_rxtxtasks/build/uart_async_rxtxtasks.bin
<span class="token punctuation">[</span><span class="token number">7</span>/7<span class="token punctuation">]</span> <span class="token builtin class-name">cd</span> /home/tunn/esp/uart_async_rxtxtasks/build/esp-idf/esptool_py <span class="token operator">&#x26;</span><span class="token punctuation">..</span><span class="token punctuation">..</span>bin /home/tunn/esp/uart_async_rxtxtasks/build/uart_async_rxtxtasks.binuart_async_rxtxtasks.bin binary size 0x31b00 bytes. Smallest app partition is 0x100000 bytes. 0xce500 bytes <span class="token punctuation">(</span><span class="token number">81</span>%<span class="token punctuation">)</span> free.

Project build complete. To flash, run this command:
/home/tunn/.espressif/python_env/idf5.1_py3.10_env/bin/python <span class="token punctuation">..</span>/esp-idf/components/esptool_py/esptool/esptool.py -p <span class="token punctuation">(</span>PORT<span class="token punctuation">)</span> -b <span class="token number">460800</span> --before default_reset --after hard_reset --chip esp32  write_flash --flash_mode dio --flash_size 2MB --flash_freq 40m 0x1000 build/bootloader/bootloader.bin 0x8000 build/partition_table/partition-table.bin 0x10000 build/uart_async_rxtxtasks.bin
or run <span class="token string">'idf.py -p (PORT) flash'</span>
</code></pre>
<p>Running <code>idf.py -p /dev/ttyUSB0 flash</code> returns:</p>
<pre class="language-shell"><code class="language-shell">Executing action: flash
Running ninja <span class="token keyword">in</span> directory /home/tunn/esp/uart_async_rxtxtasks/build
Executing <span class="token string">"ninja flash"</span><span class="token punctuation">..</span>.
<span class="token punctuation">[</span><span class="token number">1</span>/5<span class="token punctuation">]</span> <span class="token builtin class-name">cd</span> /home/tunn/esp/uart_async_rxtxtasks/build/esp-idf/esptool_py <span class="token operator">&#x26;&#x26;</span> /home/tunn/.espressif/python_env/idf5.1_py3.10_env/bin/python /home/tunn/esp/esp-idf/components/partition_table/check_sizes.py --offset 0x8000 partition --type app /home/tunn/esp/uart_async_rxtxtasks/build/partition_table/partition-table.bin /home/tunn/esp/uart_async_rxtxtasks/build/uart_async_rxtxtasks.bin
uart_async_rxtxtasks.bin binary size 0x31b00 bytes. Smallest app partition is 0x100000 bytes. 0xce500 bytes <span class="token punctuation">(</span><span class="token number">81</span>%<span class="token punctuation">)</span> free.
<span class="token punctuation">[</span><span class="token number">2</span>/5<span class="token punctuation">]</span> Performing build step <span class="token keyword">for</span> <span class="token string">'bootloader'</span>
<span class="token punctuation">[</span><span class="token number">1</span>/1<span class="token punctuation">]</span> <span class="token builtin class-name">cd</span> /home/tunn/esp/uart_async_rxtxtasks/build/bootloader/esp-idf/esptool_py <span class="token operator">&#x26;&#x26;</span> /home/tunn/.espressif/python_env/idf5.1_py3.10_env/bin/python /home/tunn/esp/esp-idf/components/partition_table/check_sizes.py --offset 0x8000 bootloader 0x1000 /home/tunn/esp/uart_async_rxtxtasks/build/bootloader/bootloader.bin
Bootloader binary size 0x6720 bytes. 0x8e0 bytes <span class="token punctuation">(</span><span class="token number">8</span>%<span class="token punctuation">)</span> free.
<span class="token punctuation">[</span><span class="token number">2</span>/3<span class="token punctuation">]</span> <span class="token builtin class-name">cd</span> /home/tunn/esp/esp-idf/components/esptool_py <span class="token operator">&#x26;&#x26;</span> /usr/bin/cmake -D <span class="token assign-left variable">IDF_PATH</span><span class="token operator">=</span>/home/tunn/esp/esp-idf -D <span class="token string">"SERIAL_TOOL=/home/tunn/.espressif/python_env/idf5.1_py3.10_env/bin/python;;/home/tunn/esp/esp-idf/components/esptool_py/esptool/esptool.py;--chip;esp32"</span> -D <span class="token string">"SERIAL_TOOL_ARGS=--before=default_reset;--after=hard_reset;write_flash;@flash_args"</span> -D <span class="token assign-left variable">WORKING_DIRECTORY</span><span class="token operator">=</span>/home/tunn/esp/uart_async_rxtxtasks/build -P /home/tunn/esp/esp-idf/components/esptool_py/run_serial_tool.cmake
esptool esp32 -p /dev/ttyUSB0 -b <span class="token number">460800</span> --before<span class="token operator">=</span>default_reset --after<span class="token operator">=</span>hard_reset write_flash --flash_mode dio --flash_freq 40m --flash_size 2MB 0x1000 bootloader/bootloader.bin 0x10000 uart_async_rxtxtasks.bin 0x8000 partition_table/partition-table.bin
esptool.py v4.5.dev0
Serial port /dev/ttyUSB0
Connecting<span class="token punctuation">..</span><span class="token punctuation">..</span>.
Chip is ESP32-D0WDQ6 <span class="token punctuation">(</span>revision v1.0<span class="token punctuation">)</span>
Features: WiFi, BT, Dual Core, 240MHz, VRef calibration <span class="token keyword">in</span> efuse, Coding Scheme None
Crystal is 26MHz
MAC: <span class="token number">84</span>:0d:8e:07:4c:fc
Uploading stub<span class="token punctuation">..</span>.
Running stub<span class="token punctuation">..</span>.
Stub running<span class="token punctuation">..</span>.
Changing baud rate to <span class="token number">460800</span>
Changed.
Configuring flash size<span class="token punctuation">..</span>.
Flash will be erased from 0x00001000 to 0x00007fff<span class="token punctuation">..</span>.
Flash will be erased from 0x00010000 to 0x00041fff<span class="token punctuation">..</span>.
Flash will be erased from 0x00008000 to 0x00008fff<span class="token punctuation">..</span>.
Compressed <span class="token number">26400</span> bytes to <span class="token number">16472</span><span class="token punctuation">..</span>.
Writing at 0x00001000<span class="token punctuation">..</span>. <span class="token punctuation">(</span><span class="token number">50</span> %<span class="token punctuation">)</span>
Writing at 0x000076ac<span class="token punctuation">..</span>. <span class="token punctuation">(</span><span class="token number">100</span> %<span class="token punctuation">)</span>
Wrote <span class="token number">26400</span> bytes <span class="token punctuation">(</span><span class="token number">16472</span> compressed<span class="token punctuation">)</span> at 0x00001000 <span class="token keyword">in</span> <span class="token number">0.7</span> seconds <span class="token punctuation">(</span>effective <span class="token number">288.5</span> kbit/s<span class="token punctuation">)</span><span class="token punctuation">..</span>.
Hash of data verified.
Compressed <span class="token number">203520</span> bytes to <span class="token number">107510</span><span class="token punctuation">..</span>.
Writing at 0x00010000<span class="token punctuation">..</span>. <span class="token punctuation">(</span><span class="token number">14</span> %<span class="token punctuation">)</span>
Writing at 0x0001ca42<span class="token punctuation">..</span>. <span class="token punctuation">(</span><span class="token number">28</span> %<span class="token punctuation">)</span>
Writing at 0x0002230b<span class="token punctuation">..</span>. <span class="token punctuation">(</span><span class="token number">42</span> %<span class="token punctuation">)</span>
Writing at 0x0002810b<span class="token punctuation">..</span>. <span class="token punctuation">(</span><span class="token number">57</span> %<span class="token punctuation">)</span>
Writing at 0x0002e59c<span class="token punctuation">..</span>. <span class="token punctuation">(</span><span class="token number">71</span> %<span class="token punctuation">)</span>
Writing at 0x00038b81<span class="token punctuation">..</span>. <span class="token punctuation">(</span><span class="token number">85</span> %<span class="token punctuation">)</span>
Writing at 0x0003e481<span class="token punctuation">..</span>. <span class="token punctuation">(</span><span class="token number">100</span> %<span class="token punctuation">)</span>
Wrote <span class="token number">203520</span> bytes <span class="token punctuation">(</span><span class="token number">107510</span> compressed<span class="token punctuation">)</span> at 0x00010000 <span class="token keyword">in</span> <span class="token number">2.6</span> seconds <span class="token punctuation">(</span>effective <span class="token number">614.6</span> kbit/s<span class="token punctuation">)</span><span class="token punctuation">..</span>.
Hash of data verified.
Compressed <span class="token number">3072</span> bytes to <span class="token number">103</span><span class="token punctuation">..</span>.
Writing at 0x00008000<span class="token punctuation">..</span>. <span class="token punctuation">(</span><span class="token number">100</span> %<span class="token punctuation">)</span>
Wrote <span class="token number">3072</span> bytes <span class="token punctuation">(</span><span class="token number">103</span> compressed<span class="token punctuation">)</span> at 0x00008000 <span class="token keyword">in</span> <span class="token number">0.1</span> seconds <span class="token punctuation">(</span>effective <span class="token number">490.8</span> kbit/s<span class="token punctuation">)</span><span class="token punctuation">..</span>.
Hash of data verified.

Leaving<span class="token punctuation">..</span>.
Hard resetting via RTS pin<span class="token punctuation">..</span>.
Done
</code></pre>
<p>Running <code>idf.py -p /dev/ttyUSB0 monitor</code> returns:</p>
<pre class="language-shell"><code class="language-shell"><span class="token punctuation">[</span><span class="token punctuation">..</span>.<span class="token punctuation">]</span>
Hello world
I <span class="token punctuation">(</span><span class="token number">46335</span><span class="token punctuation">)</span> TX_TASK: Wrote <span class="token number">13</span> bytes


�<span class="token string">'�?Hello worldI (48335) TX_TASK: Wrote 13 bytes


�'</span>�?Hello worldI <span class="token punctuation">(</span><span class="token number">50335</span><span class="token punctuation">)</span> TX_TASK: Wrote <span class="token number">13</span> bytes
</code></pre>
<h3 id="our-mainc">Our main.c<a aria-hidden="true" class="anchor-heading icon-link" href="#our-mainc"></a></h3>
<pre class="language-c"><code class="language-c"><span class="token comment">/* UART asynchronous example, that uses separate RX and TX tasks

   This example code is in the Public Domain (or CC0 licensed, at your option.)

   Unless required by applicable law or agreed to in writing, this
   software is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
   CONDITIONS OF ANY KIND, either express or implied.
*/</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"freertos/FreeRTOS.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"freertos/task.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"esp_system.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"esp_log.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"driver/uart.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"string.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"driver/gpio.h"</span></span>


<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> RX_BUF_SIZE <span class="token operator">=</span> <span class="token number">1024</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TXD_PIN</span> <span class="token expression"><span class="token punctuation">(</span>GPIO_NUM_1<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">RXD_PIN</span> <span class="token expression"><span class="token punctuation">(</span>GPIO_NUM_3<span class="token punctuation">)</span></span></span>

<span class="token comment">//Declaration d une structure pour le message</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> 
<span class="token punctuation">{</span>
<span class="token class-name">uint8_t</span> Type<span class="token punctuation">;</span>
<span class="token class-name">uint8_t</span>  Action<span class="token punctuation">;</span>
<span class="token class-name">uint8_t</span> RequestID<span class="token punctuation">;</span>
<span class="token class-name">uint8_t</span> PortID<span class="token punctuation">;</span>
<span class="token class-name">uint32_t</span> Amount<span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token class-name">message_t</span> <span class="token punctuation">;</span>


<span class="token comment">//Declaration des queues</span>
<span class="token keyword">static</span> QueueHandle_t rx_queue <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> QueueHandle_t tx_queue <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

<span class="token comment">//Declaration du HEADER pour verifier le bon etat de la communication</span>
<span class="token keyword">const</span> <span class="token class-name">uint8_t</span> HEADER<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0xCA</span><span class="token punctuation">,</span> <span class="token number">0xFE</span><span class="token punctuation">,</span> <span class="token number">0xCA</span><span class="token punctuation">,</span> <span class="token number">0xFE</span><span class="token punctuation">}</span><span class="token punctuation">;</span>




<span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token class-name">uart_config_t</span> uart_config <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span>baud_rate <span class="token operator">=</span> <span class="token number">115200</span><span class="token punctuation">,</span>
        <span class="token punctuation">.</span>data_bits <span class="token operator">=</span> UART_DATA_8_BITS<span class="token punctuation">,</span>
        <span class="token punctuation">.</span>parity <span class="token operator">=</span> UART_PARITY_DISABLE<span class="token punctuation">,</span>
        <span class="token punctuation">.</span>stop_bits <span class="token operator">=</span> UART_STOP_BITS_1<span class="token punctuation">,</span>
        <span class="token punctuation">.</span>flow_ctrl <span class="token operator">=</span> UART_HW_FLOWCTRL_DISABLE<span class="token punctuation">,</span>
        <span class="token punctuation">.</span>source_clk <span class="token operator">=</span> UART_SCLK_DEFAULT<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// We won't use a buffer for sending data.</span>
    <span class="token function">uart_driver_install</span><span class="token punctuation">(</span>UART_NUM_0<span class="token punctuation">,</span> RX_BUF_SIZE <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">uart_param_config</span><span class="token punctuation">(</span>UART_NUM_0<span class="token punctuation">,</span> <span class="token operator">&#x26;</span>uart_config<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">uart_set_pin</span><span class="token punctuation">(</span>UART_NUM_0<span class="token punctuation">,</span> TXD_PIN<span class="token punctuation">,</span> RXD_PIN<span class="token punctuation">,</span> UART_PIN_NO_CHANGE<span class="token punctuation">,</span> UART_PIN_NO_CHANGE<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
    <span class="token comment">//Initialisation des queues</span>
     rx_queue <span class="token operator">=</span> <span class="token function">xQueueCreate</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token class-name">uint32_t</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     tx_queue<span class="token operator">=</span><span class="token function">xQueueCreate</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token class-name">uint32_t</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>





<span class="token keyword">int</span> <span class="token function">sendData</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> logName<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> data<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token keyword">int</span> txBytes <span class="token operator">=</span> <span class="token function">uart_write_bytes</span><span class="token punctuation">(</span>UART_NUM_0<span class="token punctuation">,</span> data<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">ESP_LOGI</span><span class="token punctuation">(</span>logName<span class="token punctuation">,</span> <span class="token string">"Wrote %d bytes\n\n"</span><span class="token punctuation">,</span> txBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> txBytes<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">tx_task</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>arg<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>TX_TASK_TAG <span class="token operator">=</span> <span class="token string">"TX_TASK"</span><span class="token punctuation">;</span>
    <span class="token comment">////Allocation dynamique de la memoire pour les buffers de messages</span>
     <span class="token class-name">uint32_t</span> <span class="token operator">*</span>transmit<span class="token operator">=</span><span class="token punctuation">(</span><span class="token class-name">uint32_t</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token class-name">message_t</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token class-name">uint8_t</span> <span class="token operator">*</span>Header<span class="token operator">=</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token function">esp_log_level_set</span><span class="token punctuation">(</span>TX_TASK_TAG<span class="token punctuation">,</span> ESP_LOG_INFO<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    	<span class="token comment">//Stockage du premier message sur la queue dans le buffer avant envoi</span>
    	 <span class="token function">xQueueReceive</span><span class="token punctuation">(</span>tx_queue<span class="token punctuation">,</span>transmit<span class="token punctuation">,</span><span class="token number">1000</span> <span class="token operator">/</span> portTICK_PERIOD_MS<span class="token punctuation">)</span><span class="token punctuation">;</span>
    	 
    	 <span class="token comment">//Envoi du header</span>
    	<span class="token keyword">const</span> <span class="token keyword">int</span> nb_transmitH<span class="token operator">=</span><span class="token function">uart_write_bytes</span><span class="token punctuation">(</span>UART_NUM_0<span class="token punctuation">,</span> Header<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>Header<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	
    	<span class="token function">vTaskDelay</span><span class="token punctuation">(</span><span class="token number">2000</span> <span class="token operator">/</span> portTICK_PERIOD_MS<span class="token punctuation">)</span><span class="token punctuation">;</span>
    	
    	<span class="token comment">//Envoi du message</span>
        <span class="token keyword">const</span> <span class="token keyword">int</span> nb_transmit<span class="token operator">=</span><span class="token function">uart_write_bytes</span><span class="token punctuation">(</span>UART_NUM_0<span class="token punctuation">,</span> transmit<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>transmit<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">vTaskDelay</span><span class="token punctuation">(</span><span class="token number">2000</span> <span class="token operator">/</span> portTICK_PERIOD_MS<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">//Liberation des buffers</span>
    <span class="token function">free</span><span class="token punctuation">(</span>transmit<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">free</span><span class="token punctuation">(</span>Header<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">rx_task</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>arg<span class="token punctuation">)</span>
<span class="token punctuation">{</span>	
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>RX_TASK_TAG <span class="token operator">=</span> <span class="token string">"RX_TASK"</span><span class="token punctuation">;</span>
    <span class="token function">esp_log_level_set</span><span class="token punctuation">(</span>RX_TASK_TAG<span class="token punctuation">,</span> ESP_LOG_INFO<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//Allocation dynamique de la memoire pour les buffers de messages</span>
    <span class="token class-name">uint8_t</span><span class="token operator">*</span> data <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">uint8_t</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">malloc</span><span class="token punctuation">(</span>RX_BUF_SIZE<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">uint8_t</span> <span class="token operator">*</span>R_Head<span class="token operator">=</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token class-name">uint32_t</span> <span class="token operator">*</span>message<span class="token operator">=</span><span class="token punctuation">(</span><span class="token class-name">uint32_t</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token class-name">uint32_t</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token keyword">int</span> rxBytes <span class="token operator">=</span> <span class="token function">uart_read_bytes</span><span class="token punctuation">(</span>UART_NUM_0<span class="token punctuation">,</span> data<span class="token punctuation">,</span> RX_BUF_SIZE<span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token operator">/</span> portTICK_PERIOD_MS<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>rxBytes <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            data<span class="token punctuation">[</span>rxBytes<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token function">ESP_LOGI</span><span class="token punctuation">(</span>RX_TASK_TAG<span class="token punctuation">,</span> <span class="token string">"Read %d bytes: '%s'\n\n"</span><span class="token punctuation">,</span> rxBytes<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">ESP_LOG_BUFFER_HEXDUMP</span><span class="token punctuation">(</span>RX_TASK_TAG<span class="token punctuation">,</span> data<span class="token punctuation">,</span> rxBytes<span class="token punctuation">,</span> ESP_LOG_INFO<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        <span class="token comment">//Reception du header</span>
        <span class="token keyword">const</span> <span class="token keyword">int</span> nb_bitH<span class="token operator">=</span><span class="token function">uart_read_bytes</span><span class="token punctuation">(</span>UART_NUM_0<span class="token punctuation">,</span> R_Head<span class="token punctuation">,</span> <span class="token number">4</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token operator">/</span> portTICK_PERIOD_MS<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token keyword">if</span><span class="token punctuation">(</span>nb_bitH<span class="token operator">==</span><span class="token number">4</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
        	<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&#x3C;</span>nb_bitH<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        	<span class="token punctuation">{</span>        	
        		<span class="token keyword">if</span><span class="token punctuation">(</span>R_Head<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">!=</span>HEADER<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        			<span class="token punctuation">{</span>
        			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Wrong Header ! Communication Failed !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        			<span class="token keyword">break</span><span class="token punctuation">;</span>	
        			<span class="token punctuation">}</span>
        	        	        		
        	<span class="token punctuation">}</span>
        	       
        <span class="token punctuation">}</span>
        
        <span class="token comment">//Reception du message et stockage dans la queue        </span>
        <span class="token keyword">const</span> <span class="token keyword">int</span> nb_bitM<span class="token operator">=</span><span class="token function">uart_read_bytes</span><span class="token punctuation">(</span>UART_NUM_0<span class="token punctuation">,</span> message<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token class-name">message_t</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token operator">/</span> portTICK_PERIOD_MS<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">xQueueSend</span><span class="token punctuation">(</span>rx_queue<span class="token punctuation">,</span>message<span class="token punctuation">,</span><span class="token number">1000</span> <span class="token operator">/</span> portTICK_PERIOD_MS<span class="token punctuation">)</span><span class="token punctuation">;</span> 
      
    <span class="token punctuation">}</span>
    <span class="token comment">// Liberation des buffers</span>
    <span class="token function">free</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">free</span><span class="token punctuation">(</span>R_Head<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">free</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">bank_task</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>arg<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> balance<span class="token punctuation">;</span> <span class="token comment">//Solde du compte</span>
    <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>TX_TASK_TAG <span class="token operator">=</span> <span class="token string">"TX_TASK"</span><span class="token punctuation">;</span>
    <span class="token function">esp_log_level_set</span><span class="token punctuation">(</span>TX_TASK_TAG<span class="token punctuation">,</span> ESP_LOG_INFO<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">sendData</span><span class="token punctuation">(</span>TX_TASK_TAG<span class="token punctuation">,</span> <span class="token string">"Hello world\n\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">vTaskDelay</span><span class="token punctuation">(</span><span class="token number">2000</span> <span class="token operator">/</span> portTICK_PERIOD_MS<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token function">app_main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">xTaskCreate</span><span class="token punctuation">(</span>rx_task<span class="token punctuation">,</span> <span class="token string">"uart_rx_task"</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> configMAX_PRIORITIES<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">xTaskCreate</span><span class="token punctuation">(</span>tx_task<span class="token punctuation">,</span> <span class="token string">"uart_tx_task"</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> configMAX_PRIORITIES<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">xTaskCreate</span><span class="token punctuation">(</span>bank_task<span class="token punctuation">,</span> <span class="token string">"bank_task"</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> configMAX_PRIORITIES<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre>
<h2 id="our-python-code">Our Python Code<a aria-hidden="true" class="anchor-heading icon-link" href="#our-python-code"></a></h2>
<pre class="language-python"><code class="language-python"><span class="token comment"># -------------------------------------------- #</span>
<span class="token comment"># Class Client                                 #</span>
<span class="token comment"># Tasks:                                       #</span>
<span class="token comment"># - emit serial messages to the ESP card       #</span>
<span class="token comment"># - receive serial messages from the ESP card  #</span>
<span class="token comment"># -------------------------------------------- #</span>

<span class="token comment"># This module encapsulates the access for the serial port.</span>
<span class="token keyword">import</span> serial
<span class="token comment"># This module converts between Python values and C structs</span>
<span class="token comment"># represented as Python bytes objects.</span>
<span class="token keyword">from</span> struct <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token keyword">class</span> <span class="token class-name">client</span><span class="token punctuation">:</span>
    <span class="token comment"># initializing values and properties of objects</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> st_type<span class="token punctuation">,</span> st_cid<span class="token punctuation">,</span> st_rid<span class="token punctuation">,</span> st_operation<span class="token punctuation">,</span> st_ammount<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>st_type <span class="token operator">=</span> st_type              <span class="token comment"># 0 or 1 w.r.t. being resp. REQUEST or RESPONSE</span>
        self<span class="token punctuation">.</span>st_cid <span class="token operator">=</span> st_cid                <span class="token comment"># 0 .. 255 identification number for the client</span>
        self<span class="token punctuation">.</span>st_rid <span class="token operator">=</span> st_rid                <span class="token comment"># 0 .. 255 identification number for the request</span>
        self<span class="token punctuation">.</span>st_operation <span class="token operator">=</span> st_operation    <span class="token comment"># 0 or 1 w.r.t. being resp. withdraw or deposit</span>
        self<span class="token punctuation">.</span>st_ammount <span class="token operator">=</span> st_ammount        <span class="token comment"># positive integer for the ammount </span>
    
    <span class="token comment"># method structurizing the message with struct.pack</span>
    <span class="token keyword">def</span> <span class="token function">structurer</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>
        st <span class="token operator">=</span> struct<span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token string">"&#x3C;IIIQ"</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>st_type<span class="token punctuation">,</span> self<span class="token punctuation">.</span>st_cid<span class="token punctuation">,</span> self<span class="token punctuation">.</span>st_rid<span class="token punctuation">,</span> self<span class="token punctuation">.</span>st_operation<span class="token punctuation">,</span> self<span class="token punctuation">.</span>st_ammount<span class="token punctuation">)</span> 
        <span class="token keyword">return</span> st
    
    <span class="token comment"># method sending a message throw the serial port</span>
    <span class="token keyword">def</span> <span class="token function">send_message</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        ser <span class="token operator">=</span> serial<span class="token punctuation">.</span>Serial<span class="token punctuation">(</span><span class="token string">'/dev/ttyUSB0'</span><span class="token punctuation">)</span> <span class="token comment"># open serial port</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>ser<span class="token punctuation">.</span>name<span class="token punctuation">)</span>                     <span class="token comment"># check which port was really used</span>
        ser<span class="token punctuation">.</span>write<span class="token punctuation">(</span>self<span class="token punctuation">.</span>structurer<span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># write a string</span>
        ser<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>                         <span class="token comment"># close port</span>
</code></pre>
<hr>
<strong>Backlinks</strong>
<ul>
<li><a href="/UT3-AURO-2223-S10-Dendron/notes/zlr2s0g64dtr3njuzx1iylh">SATR - Systèmes et Architectures Temps Réels</a></li>
</ul></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#préparation-du-tp" title="Préparation du TP">Préparation du TP</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#prérequisinstallations" title="Prérequis/Installations">Prérequis/Installations</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#slide" title="Slide">Slide</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#this-presentation" title="This Presentation">This Presentation</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#freertos" title="FreeRTOS">FreeRTOS</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#esp-idf" title="ESP-IDF">ESP-IDF</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#hello-world" title="Hello World">Hello World</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#generic-gpio" title="Generic GPIO">Generic GPIO</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#bank-server" title="Bank: Server">Bank: Server</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#bank-uart" title="Bank: UART">Bank: UART</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#messages" title="Messages">Messages</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#queues" title="Queues">Queues</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#tasks" title="Tasks">Tasks</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#rx-task" title="Rx Task">Rx Task</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#bank-task" title="Bank Task">Bank Task</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#tx-task" title="Tx Task">Tx Task</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#client" title="Client">Client</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#suppléments" title="Suppléments">Suppléments</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#code-c" title="Code C">Code C</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#python" title="Python">Python</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#interruptions" title="Interruptions">Interruptions</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#gpio" title="GPIO">GPIO</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#uart---universal-asynchronus-receivertransmitter" title="UART - Universal Asynchronus Receiver/Transmitter">UART - Universal Asynchronus Receiver/Transmitter</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#messages-1" title="Messages">Messages</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#files-dattentes" title="Files d&#x27;attentes">Files d&#x27;attentes</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#priorités" title="Priorités">Priorités</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#test-unitaire" title="Test Unitaire">Test Unitaire</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#compte-rendu-de-tp-du-20221130" title="Compte Rendu de TP du 2022/11/30">Compte Rendu de TP du 2022/11/30</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#hello-world-1" title="Hello World">Hello World</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#generic-gpio-1" title="Generic GPIO">Generic GPIO</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#compte-rendu-de-tp-du-20221209" title="Compte Rendu de TP du 2022/12/09">Compte Rendu de TP du 2022/12/09</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#sys-emb" title="Sys. Emb.">Sys. Emb.</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#liens-utiles" title="Liens utiles">Liens utiles</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#booting" title="Booting">Booting</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#configuration-des-ports" title="Configuration des ports">Configuration des ports</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#codage" title="Codage">Codage</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#python-1" title="Python">Python</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#objectif" title="Objectif">Objectif</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#module-recommandé" title="Module recommandé">Module recommandé</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#creation-dune-interface" title="Creation d&#x27;une interface">Creation d&#x27;une interface</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#class-client" title="Class Client">Class Client</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#class-message" title="Class Message">Class Message</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#testings-on-20230108" title="Testings on 2023/01/08">Testings on 2023/01/08</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#coding-on-esp32" title="Coding on ESP32">Coding on ESP32</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#how-to-run-the-code" title="How to run the code">How to run the code</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#results" title="Results">Results</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#our-mainc" title="Our main.c">Our main.c</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#our-python-code" title="Our Python Code">Our Python Code</a></div></div></div></div></div></div></div></div></div></div></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></main></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"t9wkuehbrl7iknmi1um2po3","title":"TP1 - RTOS/ESP-IDF","desc":"","updated":1673197018549,"created":1669371857862,"custom":{},"fname":"B2.SATR.TP1","type":"note","vault":{"fsPath":"vault"},"contentHash":"00609aca3e347460342ba1b73ebd6c5b","links":[{"from":{"fname":"B2.SATR","id":"zlr2s0g64dtr3njuzx1iylh","vaultName":"vault"},"type":"backlink","position":{"start":{"line":26,"column":3,"offset":428},"end":{"line":26,"column":18,"offset":443},"indent":[]},"value":"B2.SATR.TP1"}],"anchors":{"préparation-du-tp":{"type":"header","text":"Préparation du TP","value":"préparation-du-tp","line":10,"column":0,"depth":1},"prérequisinstallations":{"type":"header","text":"Prérequis/Installations","value":"prérequisinstallations","line":23,"column":0,"depth":1},"slide":{"type":"header","text":"Slide","value":"slide","line":31,"column":0,"depth":1},"this-presentation":{"type":"header","text":"This Presentation","value":"this-presentation","line":35,"column":0,"depth":2},"freertos":{"type":"header","text":"FreeRTOS","value":"freertos","line":40,"column":0,"depth":2},"esp-idf":{"type":"header","text":"ESP-IDF","value":"esp-idf","line":44,"column":0,"depth":2},"hello-world":{"type":"header","text":"Hello World","value":"hello-world","line":48,"column":0,"depth":2},"generic-gpio":{"type":"header","text":"Generic GPIO","value":"generic-gpio","line":52,"column":0,"depth":2},"bank-server":{"type":"header","text":"Bank: Server","value":"bank-server","line":55,"column":0,"depth":2},"bank-uart":{"type":"header","text":"Bank: UART","value":"bank-uart","line":59,"column":0,"depth":2},"messages":{"type":"header","text":"Messages","value":"messages","line":63,"column":0,"depth":2},"queues":{"type":"header","text":"Queues","value":"queues","line":67,"column":0,"depth":2},"tasks":{"type":"header","text":"Tasks","value":"tasks","line":71,"column":0,"depth":2},"rx-task":{"type":"header","text":"Rx Task","value":"rx-task","line":75,"column":0,"depth":2},"bank-task":{"type":"header","text":"Bank Task","value":"bank-task","line":79,"column":0,"depth":2},"tx-task":{"type":"header","text":"Tx Task","value":"tx-task","line":83,"column":0,"depth":2},"client":{"type":"header","text":"Client","value":"client","line":87,"column":0,"depth":2},"suppléments":{"type":"header","text":"Suppléments","value":"suppléments","line":92,"column":0,"depth":1},"code-c":{"type":"header","text":"Code C","value":"code-c","line":94,"column":0,"depth":2},"python":{"type":"header","text":"Python","value":"python","line":133,"column":0,"depth":2},"interruptions":{"type":"header","text":"Interruptions","value":"interruptions","line":141,"column":0,"depth":2},"gpio":{"type":"header","text":"GPIO","value":"gpio","line":143,"column":0,"depth":3},"uart---universal-asynchronus-receivertransmitter":{"type":"header","text":"UART - Universal Asynchronus Receiver/Transmitter","value":"uart---universal-asynchronus-receivertransmitter","line":166,"column":0,"depth":2},"messages-1":{"type":"header","text":"Messages","value":"messages-1","line":185,"column":0,"depth":3},"files-dattentes":{"type":"header","text":"Files d'attentes","value":"files-dattentes","line":223,"column":0,"depth":3},"priorités":{"type":"header","text":"Priorités","value":"priorités","line":232,"column":0,"depth":3},"test-unitaire":{"type":"header","text":"Test Unitaire","value":"test-unitaire","line":239,"column":0,"depth":2},"compte-rendu-de-tp-du-20221130":{"type":"header","text":"Compte Rendu de TP du 2022/11/30","value":"compte-rendu-de-tp-du-20221130","line":243,"column":0,"depth":1},"hello-world-1":{"type":"header","text":"Hello World","value":"hello-world-1","line":245,"column":0,"depth":2},"generic-gpio-1":{"type":"header","text":"Generic GPIO","value":"generic-gpio-1","line":256,"column":0,"depth":2},"compte-rendu-de-tp-du-20221209":{"type":"header","text":"Compte Rendu de TP du 2022/12/09","value":"compte-rendu-de-tp-du-20221209","line":266,"column":0,"depth":1},"sys-emb":{"type":"header","text":"Sys. Emb.","value":"sys-emb","line":268,"column":0,"depth":2},"liens-utiles":{"type":"header","text":"Liens utiles","value":"liens-utiles","line":270,"column":0,"depth":3},"booting":{"type":"header","text":"Booting","value":"booting","line":275,"column":0,"depth":3},"configuration-des-ports":{"type":"header","text":"Configuration des ports","value":"configuration-des-ports","line":285,"column":0,"depth":3},"codage":{"type":"header","text":"Codage","value":"codage","line":296,"column":0,"depth":3},"python-1":{"type":"header","text":"Python","value":"python-1","line":301,"column":0,"depth":2},"objectif":{"type":"header","text":"Objectif","value":"objectif","line":303,"column":0,"depth":3},"module-recommandé":{"type":"header","text":"Module recommandé","value":"module-recommandé","line":310,"column":0,"depth":3},"creation-dune-interface":{"type":"header","text":"Creation d'une interface","value":"creation-dune-interface","line":314,"column":0,"depth":3},"class-client":{"type":"header","text":"Class Client","value":"class-client","line":318,"column":0,"depth":3},"class-message":{"type":"header","text":"Class Message","value":"class-message","line":323,"column":0,"depth":3},"testings-on-20230108":{"type":"header","text":"Testings on 2023/01/08","value":"testings-on-20230108","line":327,"column":0,"depth":1},"coding-on-esp32":{"type":"header","text":"Coding on ESP32","value":"coding-on-esp32","line":329,"column":0,"depth":2},"how-to-run-the-code":{"type":"header","text":"How to run the code","value":"how-to-run-the-code","line":331,"column":0,"depth":3},"results":{"type":"header","text":"Results","value":"results","line":345,"column":0,"depth":3},"our-mainc":{"type":"header","text":"Our main.c","value":"our-mainc","line":446,"column":0,"depth":3},"our-python-code":{"type":"header","text":"Our Python Code","value":"our-python-code","line":619,"column":0,"depth":2}},"children":[],"parent":"zlr2s0g64dtr3njuzx1iylh","data":{}},"body":"\u003ch1 id=\"tp1---rtosesp-idf\"\u003eTP1 - RTOS/ESP-IDF\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#tp1---rtosesp-idf\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003eMore information on the github repo: \u003ca href=\"https://github.com/TunnARK/UT3-AURO-2223-S10-Coding/tree/master/SATR-TP1-ESPBank\"\u003eSATR-TP1-ESPBank\u003c/a\u003e\u003c/p\u003e\n\u003ch1 id=\"préparation-du-tp\"\u003ePréparation du TP\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#préparation-du-tp\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003eSe familiariser avec :\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://freertos.org/taskandcr.html\"\u003eFreeRTOS - Tasks and Co-Routines\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e  --\u003e API Reference \u003e Task Creation\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003evsStackDepth\u003c/li\u003e\n\u003cli\u003evTaskDelay\u003c/li\u003e\n\u003cli\u003exTaskCreate\u003c/li\u003e\n\u003cli\u003evTaskSuspend\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/espressif/esp-idf/tree/master/examples\"\u003eles exemples d'esp-idf\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"prérequisinstallations\"\u003ePrérequis/Installations\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#prérequisinstallations\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003eInstaller ESP-IDF et suivre le \u003ccode\u003eGet Started\u003c/code\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/UT3-AURO-2223-S10-Dendron/github.com/espressif/esp-idf\"\u003eRepo GitHub ESP-IDF\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.espressif.com/projects/esp-idf/en/latest/esp32/get-started/linux-macos-setup.html\"\u003eDocs - Get-Started: Manual Install (linux-macos)\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003ePossibilité d'utiliser VS Code\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch1 id=\"slide\"\u003eSlide\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#slide\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003e\u003cimg src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-01.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"this-presentation\"\u003eThis Presentation\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#this-presentation\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-02.png\"\u003e\n\u003cimg src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-03.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"freertos\"\u003eFreeRTOS\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#freertos\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-04.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"esp-idf\"\u003eESP-IDF\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#esp-idf\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-05.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"hello-world\"\u003eHello World\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#hello-world\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-06.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"generic-gpio\"\u003eGeneric GPIO\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#generic-gpio\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-07.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"bank-server\"\u003eBank: Server\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#bank-server\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-08.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"bank-uart\"\u003eBank: UART\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#bank-uart\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-09.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"messages\"\u003eMessages\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#messages\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-10.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"queues\"\u003eQueues\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#queues\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-11.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"tasks\"\u003eTasks\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#tasks\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-12.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"rx-task\"\u003eRx Task\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#rx-task\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-13.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"bank-task\"\u003eBank Task\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#bank-task\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-14.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"tx-task\"\u003eTx Task\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#tx-task\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-15.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"client\"\u003eClient\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#client\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-16.png\"\u003e\u003c/p\u003e\n\u003ch1 id=\"suppléments\"\u003eSuppléments\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#suppléments\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003ch2 id=\"code-c\"\u003eCode C\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#code-c\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003ePour de l'embarquer le RUST est plus robuste que le C\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003ca href=\"http://cliffle.com/blog/not-thread-safe/#the-bank-account-example\"\u003eLe code à utiliser ici :\u003c/a\u003e\u003c/p\u003e\n\u003cpre class=\"language-c++\"\u003e\u003ccode class=\"language-c++\"\u003e/*\n * Stores information about a bank account.\n */\nstruct bank_account {\n    /* How much money is in the account. */\n    int balance; /* never use floats for managing money (too much approximation) */\n};\n\n/*\n * Deposits 'amt' into the 'account' and returns the new balance.\n */\nint deposit(struct bank_account *account, int amt) {\n    account-\u003ebalance += amt;\n    return account-\u003ebalance;\n}\n\n/*\n * Tries to withdraw 'amt' from the account. Returns 'true' if it\n * succeeded, 'false' if the account didn't contain enough.\n */\nbool withdraw(struct bank_account *account, int amt) {\n    if (account-\u003ebalance \u003e= amt) {\n        account-\u003ebalance -= amt;\n        return true;\n    } else {\n        return false;\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eRemarque:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003epour connaitre l'état du compte il suffit de faire \u003ccode\u003edeposit(0)\u003c/code\u003e est la fct retournera ce qui reste dans le compte\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"python\"\u003ePython\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#python\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cpre class=\"language-python\"\u003e\u003ccode class=\"language-Python\"\u003e\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003edeposit\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eamt \u003cspan class=\"token builtin\"\u003eint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eint\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003ewithdraw\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eamt \u003cspan class=\"token builtin\"\u003eint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eint\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"interruptions\"\u003eInterruptions\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#interruptions\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch3 id=\"gpio\"\u003eGPIO\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#gpio\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eLe code de gestion des interruptions\u003ccode\u003e~/esp/generic_gpio/main/gpio_example_main.c\u003c/code\u003e\u003c/p\u003e\n\u003cpre class=\"language-c\"\u003e\u003ccode class=\"language-C\"\u003e\u003cspan class=\"token keyword\"\u003estatic\u003c/span\u003e QueueHandle_t gpio_evt_queue \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token constant\"\u003eNULL\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"token keyword\"\u003evoid\u003c/span\u003e IRAM_ATTR \u003cspan class=\"token function\"\u003egpio_isr_handler\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003evoid\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e arg\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token class-name\"\u003euint32_t\u003c/span\u003e gpio_num \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token class-name\"\u003euint32_t\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e arg\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003exQueueSendFromISR\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003egpio_evt_queue\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026#x26;\u003c/span\u003egpio_num\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token constant\"\u003eNULL\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"token keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"token function\"\u003egpio_task_example\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003evoid\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e arg\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token class-name\"\u003euint32_t\u003c/span\u003e io_num\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token function\"\u003exQueueReceive\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003egpio_evt_queue\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026#x26;\u003c/span\u003eio_num\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e portMAX_DELAY\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"token function\"\u003eprintf\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"GPIO[%\"\u003c/span\u003ePRIu32\u003cspan class=\"token string\"\u003e\"] intr, val: %d\\n\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e io_num\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token function\"\u003egpio_get_level\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eio_num\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"uart---universal-asynchronus-receivertransmitter\"\u003eUART - Universal Asynchronus Receiver/Transmitter\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#uart---universal-asynchronus-receivertransmitter\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/peripherals/uart.html\"\u003elien vers la doc UART\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eUn UART n'est pas un bus temps réel\nbuffer entre le code et les files om gere pas ca\u003c/li\u003e\n\u003cli\u003eChaque UART a sa propre horloge (dans le cas d'un USRT (synchronus) on rajoute une clock de référence)\u003c/li\u003e\n\u003cli\u003eequivalence reseau: 2eme couche du modele OSI donc similaire a une tram avec son protocle\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!--8 data graph--\u003e\n\u003c!-- ![](/assets/images/B2.SATR.TP1.RTOSESPIDF.NotesGEA-01.png) --\u003e\n\u003c!-- ![](/assets/images/B2.SATR.TP1.RTOSESPIDF.NotesGEA-02.png) --\u003e\n\u003c!-- ![](/assets/images/B2.SATR.TP1.RTOSESPIDF.NotesGEA-03.png) --\u003e\n\u003cp\u003eATTETNION: \u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ele pc est en 64 bit mais l'ESP32 est sur du 32 bit donc la taille d'un \u003ccode\u003eint\u003c/code\u003e n'est pas la meme\u003c/li\u003e\n\u003cli\u003ecepedant avec un \u003ccode\u003eint\u003c/code\u003e en 32 bit on peut gérer jusqu'à 40 millions d'euros i.e. \u003cspan class=\"math math-inline\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003cmo\u003e∗\u003c/mo\u003e\u003cmn\u003e32\u003c/mn\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmi mathvariant=\"normal\"\u003e/\u003c/mi\u003e\u003cmn\u003e100\u003c/mn\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e42\u003c/mn\u003e\u003cmtext\u003e  \u003c/mtext\u003e\u003cmi\u003em\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmi\u003el\u003c/mi\u003e\u003cmi\u003el\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmi\u003eo\u003c/mi\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmi\u003es\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e(2*32-1)/100=42\\;millions\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e2\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e∗\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e32\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mord\"\u003e/100\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e42\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003emi\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.01968em;\"\u003ell\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ei\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eo\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003es\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"messages-1\"\u003eMessages\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#messages-1\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eCes messages devront prendre en compte :\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eHeader: [OxCA,OxFE,OxCA,OxFE]\u003c/li\u003e\n\u003cli\u003etype: REQ/REP\u003c/li\u003e\n\u003cli\u003eClient ID\u003c/li\u003e\n\u003cli\u003eReq ID\u003c/li\u003e\n\u003cli\u003eOperation\u003c/li\u003e\n\u003cli\u003eAmmount (32 bit int)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eExemple:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e1 client et 1 serveur pour le moment\u003c/li\u003e\n\u003cli\u003ele client fait une requete:\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eM1(type=REQ, CID=1, RID=1, Amount=100, Op=1)\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eIl recoit alors la réponse:\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eM1(type=REP, CID=1, RID=1, Amount=200, Op=1)\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eOn remarque alors qu'il peut y avoir un probleme avec ce jeu de parametres car on ne sait pas comment gérer l'absence et l'attente de réponse --\u003e introduire du coup un param \u003ccode\u003etime out\u003c/code\u003e de 1 sec\u003c/li\u003e\n\u003cli\u003eAutre soucis c'est la synchronisation des canaux --\u003e ajouter un \u003ccode\u003eHEADER\u003c/code\u003e\n\u003cul\u003e\n\u003cli\u003eune autre option aurait été de faire un \u003ccode\u003e3handshake\u003c/code\u003e (soit \u003ccode\u003eSync\u003eSync/Ack\u003eAck\u003c/code\u003e)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eDu coup on reprend l'échange précédant avec le header, on envoit dans l'ordre :\n\u003col\u003e\n\u003cli\u003e4 oct(s): Header\u003c/li\u003e\n\u003cli\u003e1 oct(s): Type\u003c/li\u003e\n\u003cli\u003e1 oct(s): Client ID (ou mieux un \u003cstrong\u003enuméro de port\u003c/strong\u003e ! attention ceci est valide si il n'y a pas de bus commun entre les pc)\u003c/li\u003e\n\u003cli\u003e1 oct(s): Req ID \n\u003cul\u003e\n\u003cli\u003eici peut etre 1 oct suffit pas mais en vrai avec 1 oct on doit avoir plus de 256 requetes non répondus en moins d'une seconde donc ça ira\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e1 oct(s): Operation\u003c/li\u003e\n\u003cli\u003e4 oct(s): Amount\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003eUne autre organisation plus optimale niveau mémoire et temps d'envoi/recpetion (mais cela rend la programmation plus risquée lors de la conception du coup on va plustot préférencer l'option précédente)\n\u003col\u003e\n\u003cli\u003e4 oct(s): Header\u003c/li\u003e\n\u003cli\u003e1 oct(s): Type + Operation\u003c/li\u003e\n\u003cli\u003e1 oct(s): Client ID\u003c/li\u003e\n\u003cli\u003e1 oct(s): Req ID\u003c/li\u003e\n\u003cli\u003e4 oct(s): Amount\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- Un exemple de séquence de message : --\u003e\n\u003c!-- ![](/assets/images/B2.SATR.TP1.RTOSESPIDF.NotesGEA-04.png) --\u003e\n\u003cul\u003e\n\u003cli\u003eLa configuration python avec \u003ccode\u003edep/withdraw/tx/rx\u003c/code\u003e ne permettra pas d'envoyer plusieurs requetes en meme temps car les fcts \u003ccode\u003edep\u003c/code\u003e et \u003ccode\u003ewith\u003c/code\u003e appel \u003ccode\u003etx\u003c/code\u003e et \u003ccode\u003erx\u003c/code\u003e (si on a le temps on verra comment gerer de l'asynchrone en python)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"files-dattentes\"\u003eFiles d'attentes\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#files-dattentes\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eOn crée un pointeur contenant toute les files d'attentes (\u003ccode\u003eRx\u003c/code\u003e,\u003ccode\u003eTx1\u003c/code\u003e, \u003ccode\u003eTx2\u003c/code\u003e, \u003ccode\u003eTx3\u003c/code\u003e, ...).\u003c/p\u003e\n\u003cp\u003eChaque files nécessite une capacité (nombre de requete qu'elle contient ici 10) et d'une taille pour chaque requete\u003c/p\u003e\n\u003cpre class=\"language-c\"\u003e\u003ccode class=\"language-C\"\u003e\u003cspan class=\"token comment\"\u003e//create a queue to handle gpio event from isr\u003c/span\u003e\n    gpio_evt_queue \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003exQueueCreate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e10\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003esizeof\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token class-name\"\u003euint32_t\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"priorités\"\u003ePriorités\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#priorités\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eMaintenant quelles priorités données aux tâches, il y a 3 philosophies :\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eBack Pressure: donner la prior. à Tx pour eviter des bottle neck\u003c/li\u003e\n\u003cli\u003eConservative : donner la prior. à Rx pour ne pas perdre de donner\u003c/li\u003e\n\u003cli\u003eFairly: donner la priorité à la tache la plus solicité ici bank puisque qu'il a 3 copie de Tx/Rx qui l'appelle\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"test-unitaire\"\u003eTest Unitaire\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#test-unitaire\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eTDD - Test Driver Development\u003c/p\u003e\n\u003ch1 id=\"compte-rendu-de-tp-du-20221130\"\u003eCompte Rendu de TP du 2022/11/30\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#compte-rendu-de-tp-du-20221130\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003ch2 id=\"hello-world-1\"\u003eHello World\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#hello-world-1\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003eSuivre le \u003ca href=\"https://docs.espressif.com/projects/esp-idf/en/latest/esp32/get-started/linux-macos-setup.html#\"\u003eguide d'installation\u003c/a\u003e jusqu'à l'étape \u003ccode\u003eConfigure Your Project\u003c/code\u003e (etape exclue).\u003c/li\u003e\n\u003cli\u003eIgnorer cette étape, mais à la place modifier le fichier \u003ccode\u003e/workspace/esp/hello_world/sdkconfig\u003c/code\u003e pour reconfigurer la fréquence de \u003cspan class=\"math math-inline\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e40\u003c/mn\u003e\u003cmi\u003eM\u003c/mi\u003e\u003cmi\u003eH\u003c/mi\u003e\u003cmi\u003ez\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e40MHz\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e40\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\"\u003eM\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.04398em;\"\u003eHz\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e à \u003cspan class=\"math math-inline\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e26\u003c/mn\u003e\u003cmi\u003eM\u003c/mi\u003e\u003cmi\u003eH\u003c/mi\u003e\u003cmi\u003ez\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e26MHz\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e26\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\"\u003eM\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.04398em;\"\u003eHz\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e (cf slide 6 pour plus d'info).\u003c/li\u003e\n\u003cli\u003eContinuer les étapes restantes du \u003ca href=\"https://docs.espressif.com/projects/esp-idf/en/latest/esp32/get-started/linux-macos-setup.html#\"\u003eguide d'installation\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003eUne fois le \u003ccode\u003eBuild Project\u003c/code\u003e terminé, lancer le flash\u003c/li\u003e\n\u003cli\u003eSi vous recevez une erreur du style \"port introuvalbe\", s'assurer que la session utilisateur a acces au groupe\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003ell \\dev\\ttyUSB0\u003c/code\u003e (ou \u003ccode\u003ell \\dev\\PORT\u003c/code\u003e) pour connaitre les droits d'accès du port\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003esudo usermod -aG GROUP USERNAME\u003c/code\u003e pour ajouter un user dans un groupe\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003egroups\u003c/code\u003e ne se met pas à jour directement (visuellement) donc faire \u003ccode\u003enewgrp GROUP\u003c/code\u003e pour mettre à jour le groupe et relancer \u003ccode\u003egroups\u003c/code\u003e pour lister les utilisateurs (vérifier que l'utilisateur ajouter et bien présent).\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"generic-gpio-1\"\u003eGeneric GPIO\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#generic-gpio-1\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003eSe placer dans le workspace (ici \u003ccode\u003e/esp/\u003c/code\u003e) et copier-coller le dossier exemple gpio \u003ccode\u003ecp -r $IDF_PATH/examples/peripherals/gpio/generic_gpio .\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eSe placer dans \u003ccode\u003e/workspace/generic_gpio\u003c/code\u003e et lancer \u003ccode\u003eidf.py set-target esp32\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eModifier le fichier \u003ccode\u003e/workspace/generic_gpio/sdkconfig\u003c/code\u003e pour reconfigurer la fréquence de \u003cspan class=\"math math-inline\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e40\u003c/mn\u003e\u003cmi\u003eM\u003c/mi\u003e\u003cmi\u003eH\u003c/mi\u003e\u003cmi\u003ez\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e40MHz\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e40\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\"\u003eM\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.04398em;\"\u003eHz\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e à \u003cspan class=\"math math-inline\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e26\u003c/mn\u003e\u003cmi\u003eM\u003c/mi\u003e\u003cmi\u003eH\u003c/mi\u003e\u003cmi\u003ez\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e26MHz\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e26\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\"\u003eM\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.04398em;\"\u003eHz\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e (cf slide 7 pour plus d'info).\u003c/li\u003e\n\u003cli\u003eLancer le build \u003ccode\u003eidf.py build\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eFlasher la carte \u003ccode\u003eidf.py flash\u003c/code\u003e (ou \u003ccode\u003eidf.py -p PORT flash\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003eLe code est déjà en train de s'exécuter en background pour le voir lancer \u003ccode\u003eidf.py monitor\u003c/code\u003e (ou \u003ccode\u003eidf.py -p PORT monitor\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003eSe familiariser avec le code de communication \u003ccode\u003e/workspace/generic_gpio/main/\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch1 id=\"compte-rendu-de-tp-du-20221209\"\u003eCompte Rendu de TP du 2022/12/09\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#compte-rendu-de-tp-du-20221209\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003ch2 id=\"sys-emb\"\u003eSys. Emb.\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#sys-emb\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch3 id=\"liens-utiles\"\u003eLiens utiles\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#liens-utiles\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.espressif.com/projects/esp-idf/en/latest/esp32/get-started/index.html#\"\u003eGet Started\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/peripherals/uart.html\"\u003eDocs UART\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"booting\"\u003eBooting\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#booting\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eSe placer dans le workspace (ici \u003ccode\u003e/esp/\u003c/code\u003e) et copier-coller le dossier exemple gpio\n\u003ccode\u003ecp -r /esp/esp-idf/examples/peripherals/uart/uart_async_rxtxtasks/ .\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eSe placer dans \u003ccode\u003e/workspace/uart_async_rxtxtasks\u003c/code\u003e et lancer \u003ccode\u003eidf.py set-target esp32\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eModifier le fichier \u003ccode\u003e/workspace/uart_async_rxtxtasks/sdkconfig\u003c/code\u003e pour reconfigurer la fréquence de \u003cspan class=\"math math-inline\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e40\u003c/mn\u003e\u003cmi\u003eM\u003c/mi\u003e\u003cmi\u003eH\u003c/mi\u003e\u003cmi\u003ez\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e40MHz\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e40\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\"\u003eM\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.04398em;\"\u003eHz\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e à \u003cspan class=\"math math-inline\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e26\u003c/mn\u003e\u003cmi\u003eM\u003c/mi\u003e\u003cmi\u003eH\u003c/mi\u003e\u003cmi\u003ez\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e26MHz\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e26\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\"\u003eM\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.04398em;\"\u003eHz\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e (cf slide 7 pour plus d'info).\u003c/li\u003e\n\u003cli\u003eLancer le build \u003ccode\u003eidf.py build\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eFlasher la carte \u003ccode\u003eidf.py flash\u003c/code\u003e (ou \u003ccode\u003eidf.py -p PORT flash\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003eLe code est déjà en train de s'exécuter en background pour le voir lancer \u003ccode\u003eidf.py monitor\u003c/code\u003e (ou \u003ccode\u003eidf.py -p PORT monitor\u003c/code\u003e)\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"configuration-des-ports\"\u003eConfiguration des ports\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#configuration-des-ports\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eOuvrir le fichier \u003ccode\u003emain/uart_async_rxtxtasks_main.c\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eModifier les ports par défaut par :\n\u003cul\u003e\n\u003cli\u003e\n\u003cpre class=\"language-c\"\u003e\u003ccode class=\"language-C\"\u003e  \u003cspan class=\"token comment\"\u003e// Dans /main/uart_async_rxtxtasks_main.c\u003c/span\u003e\n  \u003cspan class=\"token macro property\"\u003e\u003cspan class=\"token directive-hash\"\u003e#\u003c/span\u003e\u003cspan class=\"token directive keyword\"\u003edefine\u003c/span\u003e \u003cspan class=\"token macro-name\"\u003eTXD_PIN\u003c/span\u003e \u003cspan class=\"token expression\"\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eGPIO_NUM_1\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token macro property\"\u003e\u003cspan class=\"token directive-hash\"\u003e#\u003c/span\u003e\u003cspan class=\"token directive keyword\"\u003edefine\u003c/span\u003e \u003cspan class=\"token macro-name\"\u003eRXD_PIN\u003c/span\u003e \u003cspan class=\"token expression\"\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eGPIO_NUM_3\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eDe plus, remplacer dans ce code toute apparition de \u003ccode\u003eUART_NUM_1\u003c/code\u003e par \u003ccode\u003eUART_NUM_0\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"codage\"\u003eCodage\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#codage\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003ch2 id=\"python-1\"\u003ePython\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#python-1\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch3 id=\"objectif\"\u003eObjectif\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#objectif\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eCréer un code python pour instancier et visualiser les fonctionnalités du projet Bank\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e- une fonciton `Création/Suppression` de compte bancaire\n- une fonction `Deposit`\n- une fonction `Withdraw`\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"module-recommandé\"\u003eModule recommandé\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#module-recommandé\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eModule \u003ccode\u003estruct\u003c/code\u003e, \u003ccode\u003ebserial\u003c/code\u003e\u003c/p\u003e\n\u003ch3 id=\"creation-dune-interface\"\u003eCreation d'une interface\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#creation-dune-interface\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eLien Utile: \u003ca href=\"https://www.cours-gratuit.com/tutoriel-python/tutoriel-python-programmer-une-interface-graphique-avec-tkinter-partie-1#_Toc52998640\"\u003eInterface Python avec Tkinter\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"class-client\"\u003eClass Client\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#class-client\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003esur python le typage est dynamic donc le type est assigné selon ce qui arrive\u003c/li\u003e\n\u003cli\u003ele header n'est pas a mettre dans le struct.pack car il précéde le message\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"class-message\"\u003eClass Message\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#class-message\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eclass message\u003c/p\u003e\n\u003ch1 id=\"testings-on-20230108\"\u003eTestings on 2023/01/08\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#testings-on-20230108\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003ch2 id=\"coding-on-esp32\"\u003eCoding on ESP32\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#coding-on-esp32\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch3 id=\"how-to-run-the-code\"\u003eHow to run the code\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#how-to-run-the-code\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eOpen New Terminal \u003c/li\u003e\n\u003cli\u003eInstall Environment\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ecd /workspace/esp-idf/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e./install.sh esp32\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e. ./export.sh\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eSett up UART Environment\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ecd /workspace/uart_async_rxtxtasks/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eidf.py set-target esp32\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eidf.py build\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eidf.py -p /dev/ttyUSB0 flash\u003c/code\u003e (check Port ID in \u003ccode\u003e/dev/\u003c/code\u003e before running the command)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eidf.py -p /dev/ttyUSB0 monitor\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"results\"\u003eResults\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#results\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eRunning \u003ccode\u003eidf.py build\u003c/code\u003e returns :\u003c/p\u003e\n\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003eExecuting action: all \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ealiases: build\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nRunning ninja \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e directory /home/tunn/esp/uart_async_rxtxtasks/build\nExecuting \u003cspan class=\"token string\"\u003e\"ninja all\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e.\n\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e/1\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token builtin class-name\"\u003ecd\u003c/span\u003e /home/tunn/esp/uart_async_rxtxtasks/build/bootloader/esp-idf/e\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e.000 /home/tunn/esp/uart_async_rxtxtasks/build/bootloader/bootloader.binBootloader binary size 0x6720 bytes. 0x8e0 bytes \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e8\u003c/span\u003e%\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e free.\n\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e/7\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e Building C object esp-idf/main/CMakeFiles/__idf_main.dir/uart_async_rxtxtasks_main.c.obj/home/tunn/esp/uart_async_rxtxtasks/main/uart_async_rxtxtasks_main.c: In \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token string\"\u003e'tx_task'\u003c/span\u003e\u003cspan class=\"token builtin class-name\"\u003e:\u003c/span\u003e\n/home/tunn/esp/uart_async_rxtxtasks/main/uart_async_rxtxtasks_main.c:98:19: warning: unused variable \u003cspan class=\"token string\"\u003e'nb_transmit'\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e-Wunused-variable\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n   \u003cspan class=\"token number\"\u003e98\u003c/span\u003e \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e         const int \u003cspan class=\"token assign-left variable\"\u003enb_transmit\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003euart_write_bytes\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eUART_NUM_0, transmit, sizeof\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etransmit\u003cspan class=\"token punctuation\"\u003e))\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e                   ^~~~~~~~~~~\n/home/tunn/esp/uart_async_rxtxtasks/main/uart_async_rxtxtasks_main.c:93:19: warning: unused variable \u003cspan class=\"token string\"\u003e'nb_transmitH'\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e-Wunused-variable\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n   \u003cspan class=\"token number\"\u003e93\u003c/span\u003e \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e         const int \u003cspan class=\"token assign-left variable\"\u003enb_transmitH\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003euart_write_bytes\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eUART_NUM_0, Header, sizeof\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eHeader\u003cspan class=\"token punctuation\"\u003e))\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e                   ^~~~~~~~~~~~\n/home/tunn/esp/uart_async_rxtxtasks/main/uart_async_rxtxtasks_main.c: In \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token string\"\u003e'rx_task'\u003c/span\u003e\u003cspan class=\"token builtin class-name\"\u003e:\u003c/span\u003e\n/home/tunn/esp/uart_async_rxtxtasks/main/uart_async_rxtxtasks_main.c:143:19: warning: unused variable \u003cspan class=\"token string\"\u003e'nb_bitM'\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e-Wunused-variable\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"token number\"\u003e143\u003c/span\u003e \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e         const int \u003cspan class=\"token assign-left variable\"\u003enb_bitM\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003euart_read_bytes\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eUART_NUM_0, message, sizeof\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emessage_t\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e, \u003cspan class=\"token number\"\u003e1000\u003c/span\u003e / portTICK_PERIOD_MS\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e                   ^~~~~~~\n/home/tunn/esp/uart_async_rxtxtasks/main/uart_async_rxtxtasks_main.c: In \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token string\"\u003e'bank_task'\u003c/span\u003e\u003cspan class=\"token builtin class-name\"\u003e:\u003c/span\u003e\n/home/tunn/esp/uart_async_rxtxtasks/main/uart_async_rxtxtasks_main.c:156:9: warning: unused variable \u003cspan class=\"token string\"\u003e'balance'\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e-Wunused-variable\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"token number\"\u003e156\u003c/span\u003e \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e     int balance\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e //Solde \u003cspan class=\"token function\"\u003edu\u003c/span\u003e compte\n      \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e         ^~~~~~~\n\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e6\u003c/span\u003e/7\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e Generating binary image from built executableesptool.py v4.5.dev0\nCreating esp32 image\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e.\nMerged \u003cspan class=\"token number\"\u003e2\u003c/span\u003e ELF sections\nSuccessfully created esp32 image.\nGenerated /home/tunn/esp/uart_async_rxtxtasks/build/uart_async_rxtxtasks.bin\n\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e7\u003c/span\u003e/7\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token builtin class-name\"\u003ecd\u003c/span\u003e /home/tunn/esp/uart_async_rxtxtasks/build/esp-idf/esptool_py \u003cspan class=\"token operator\"\u003e\u0026#x26;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003ebin /home/tunn/esp/uart_async_rxtxtasks/build/uart_async_rxtxtasks.binuart_async_rxtxtasks.bin binary size 0x31b00 bytes. Smallest app partition is 0x100000 bytes. 0xce500 bytes \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e81\u003c/span\u003e%\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e free.\n\nProject build complete. To flash, run this command:\n/home/tunn/.espressif/python_env/idf5.1_py3.10_env/bin/python \u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e/esp-idf/components/esptool_py/esptool/esptool.py -p \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ePORT\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e -b \u003cspan class=\"token number\"\u003e460800\u003c/span\u003e --before default_reset --after hard_reset --chip esp32  write_flash --flash_mode dio --flash_size 2MB --flash_freq 40m 0x1000 build/bootloader/bootloader.bin 0x8000 build/partition_table/partition-table.bin 0x10000 build/uart_async_rxtxtasks.bin\nor run \u003cspan class=\"token string\"\u003e'idf.py -p (PORT) flash'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eRunning \u003ccode\u003eidf.py -p /dev/ttyUSB0 flash\u003c/code\u003e returns:\u003c/p\u003e\n\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003eExecuting action: flash\nRunning ninja \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e directory /home/tunn/esp/uart_async_rxtxtasks/build\nExecuting \u003cspan class=\"token string\"\u003e\"ninja flash\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e.\n\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e/5\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token builtin class-name\"\u003ecd\u003c/span\u003e /home/tunn/esp/uart_async_rxtxtasks/build/esp-idf/esptool_py \u003cspan class=\"token operator\"\u003e\u0026#x26;\u0026#x26;\u003c/span\u003e /home/tunn/.espressif/python_env/idf5.1_py3.10_env/bin/python /home/tunn/esp/esp-idf/components/partition_table/check_sizes.py --offset 0x8000 partition --type app /home/tunn/esp/uart_async_rxtxtasks/build/partition_table/partition-table.bin /home/tunn/esp/uart_async_rxtxtasks/build/uart_async_rxtxtasks.bin\nuart_async_rxtxtasks.bin binary size 0x31b00 bytes. Smallest app partition is 0x100000 bytes. 0xce500 bytes \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e81\u003c/span\u003e%\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e free.\n\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e/5\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e Performing build step \u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"token string\"\u003e'bootloader'\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e/1\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token builtin class-name\"\u003ecd\u003c/span\u003e /home/tunn/esp/uart_async_rxtxtasks/build/bootloader/esp-idf/esptool_py \u003cspan class=\"token operator\"\u003e\u0026#x26;\u0026#x26;\u003c/span\u003e /home/tunn/.espressif/python_env/idf5.1_py3.10_env/bin/python /home/tunn/esp/esp-idf/components/partition_table/check_sizes.py --offset 0x8000 bootloader 0x1000 /home/tunn/esp/uart_async_rxtxtasks/build/bootloader/bootloader.bin\nBootloader binary size 0x6720 bytes. 0x8e0 bytes \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e8\u003c/span\u003e%\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e free.\n\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e/3\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token builtin class-name\"\u003ecd\u003c/span\u003e /home/tunn/esp/esp-idf/components/esptool_py \u003cspan class=\"token operator\"\u003e\u0026#x26;\u0026#x26;\u003c/span\u003e /usr/bin/cmake -D \u003cspan class=\"token assign-left variable\"\u003eIDF_PATH\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e/home/tunn/esp/esp-idf -D \u003cspan class=\"token string\"\u003e\"SERIAL_TOOL=/home/tunn/.espressif/python_env/idf5.1_py3.10_env/bin/python;;/home/tunn/esp/esp-idf/components/esptool_py/esptool/esptool.py;--chip;esp32\"\u003c/span\u003e -D \u003cspan class=\"token string\"\u003e\"SERIAL_TOOL_ARGS=--before=default_reset;--after=hard_reset;write_flash;@flash_args\"\u003c/span\u003e -D \u003cspan class=\"token assign-left variable\"\u003eWORKING_DIRECTORY\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e/home/tunn/esp/uart_async_rxtxtasks/build -P /home/tunn/esp/esp-idf/components/esptool_py/run_serial_tool.cmake\nesptool esp32 -p /dev/ttyUSB0 -b \u003cspan class=\"token number\"\u003e460800\u003c/span\u003e --before\u003cspan class=\"token operator\"\u003e=\u003c/span\u003edefault_reset --after\u003cspan class=\"token operator\"\u003e=\u003c/span\u003ehard_reset write_flash --flash_mode dio --flash_freq 40m --flash_size 2MB 0x1000 bootloader/bootloader.bin 0x10000 uart_async_rxtxtasks.bin 0x8000 partition_table/partition-table.bin\nesptool.py v4.5.dev0\nSerial port /dev/ttyUSB0\nConnecting\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e.\nChip is ESP32-D0WDQ6 \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003erevision v1.0\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nFeatures: WiFi, BT, Dual Core, 240MHz, VRef calibration \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e efuse, Coding Scheme None\nCrystal is 26MHz\nMAC: \u003cspan class=\"token number\"\u003e84\u003c/span\u003e:0d:8e:07:4c:fc\nUploading stub\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e.\nRunning stub\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e.\nStub running\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e.\nChanging baud rate to \u003cspan class=\"token number\"\u003e460800\u003c/span\u003e\nChanged.\nConfiguring flash size\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e.\nFlash will be erased from 0x00001000 to 0x00007fff\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e.\nFlash will be erased from 0x00010000 to 0x00041fff\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e.\nFlash will be erased from 0x00008000 to 0x00008fff\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e.\nCompressed \u003cspan class=\"token number\"\u003e26400\u003c/span\u003e bytes to \u003cspan class=\"token number\"\u003e16472\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e.\nWriting at 0x00001000\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e. \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e50\u003c/span\u003e %\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nWriting at 0x000076ac\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e. \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e100\u003c/span\u003e %\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nWrote \u003cspan class=\"token number\"\u003e26400\u003c/span\u003e bytes \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e16472\u003c/span\u003e compressed\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e at 0x00001000 \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"token number\"\u003e0.7\u003c/span\u003e seconds \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eeffective \u003cspan class=\"token number\"\u003e288.5\u003c/span\u003e kbit/s\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e.\nHash of data verified.\nCompressed \u003cspan class=\"token number\"\u003e203520\u003c/span\u003e bytes to \u003cspan class=\"token number\"\u003e107510\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e.\nWriting at 0x00010000\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e. \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e14\u003c/span\u003e %\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nWriting at 0x0001ca42\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e. \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e28\u003c/span\u003e %\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nWriting at 0x0002230b\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e. \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e42\u003c/span\u003e %\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nWriting at 0x0002810b\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e. \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e57\u003c/span\u003e %\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nWriting at 0x0002e59c\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e. \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e71\u003c/span\u003e %\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nWriting at 0x00038b81\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e. \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e85\u003c/span\u003e %\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nWriting at 0x0003e481\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e. \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e100\u003c/span\u003e %\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nWrote \u003cspan class=\"token number\"\u003e203520\u003c/span\u003e bytes \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e107510\u003c/span\u003e compressed\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e at 0x00010000 \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"token number\"\u003e2.6\u003c/span\u003e seconds \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eeffective \u003cspan class=\"token number\"\u003e614.6\u003c/span\u003e kbit/s\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e.\nHash of data verified.\nCompressed \u003cspan class=\"token number\"\u003e3072\u003c/span\u003e bytes to \u003cspan class=\"token number\"\u003e103\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e.\nWriting at 0x00008000\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e. \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e100\u003c/span\u003e %\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nWrote \u003cspan class=\"token number\"\u003e3072\u003c/span\u003e bytes \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e103\u003c/span\u003e compressed\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e at 0x00008000 \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"token number\"\u003e0.1\u003c/span\u003e seconds \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eeffective \u003cspan class=\"token number\"\u003e490.8\u003c/span\u003e kbit/s\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e.\nHash of data verified.\n\nLeaving\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e.\nHard resetting via RTS pin\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e.\nDone\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eRunning \u003ccode\u003eidf.py -p /dev/ttyUSB0 monitor\u003c/code\u003e returns:\u003c/p\u003e\n\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e.\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\nHello world\nI \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e46335\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e TX_TASK: Wrote \u003cspan class=\"token number\"\u003e13\u003c/span\u003e bytes\n\n\n�\u003cspan class=\"token string\"\u003e'�?Hello worldI (48335) TX_TASK: Wrote 13 bytes\n\n\n�'\u003c/span\u003e�?Hello worldI \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e50335\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e TX_TASK: Wrote \u003cspan class=\"token number\"\u003e13\u003c/span\u003e bytes\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"our-mainc\"\u003eOur main.c\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#our-mainc\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cpre class=\"language-c\"\u003e\u003ccode class=\"language-c\"\u003e\u003cspan class=\"token comment\"\u003e/* UART asynchronous example, that uses separate RX and TX tasks\n\n   This example code is in the Public Domain (or CC0 licensed, at your option.)\n\n   Unless required by applicable law or agreed to in writing, this\n   software is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n   CONDITIONS OF ANY KIND, either express or implied.\n*/\u003c/span\u003e\n\n\u003cspan class=\"token macro property\"\u003e\u003cspan class=\"token directive-hash\"\u003e#\u003c/span\u003e\u003cspan class=\"token directive keyword\"\u003einclude\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"freertos/FreeRTOS.h\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token macro property\"\u003e\u003cspan class=\"token directive-hash\"\u003e#\u003c/span\u003e\u003cspan class=\"token directive keyword\"\u003einclude\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"freertos/task.h\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token macro property\"\u003e\u003cspan class=\"token directive-hash\"\u003e#\u003c/span\u003e\u003cspan class=\"token directive keyword\"\u003einclude\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"esp_system.h\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token macro property\"\u003e\u003cspan class=\"token directive-hash\"\u003e#\u003c/span\u003e\u003cspan class=\"token directive keyword\"\u003einclude\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"esp_log.h\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token macro property\"\u003e\u003cspan class=\"token directive-hash\"\u003e#\u003c/span\u003e\u003cspan class=\"token directive keyword\"\u003einclude\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"driver/uart.h\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token macro property\"\u003e\u003cspan class=\"token directive-hash\"\u003e#\u003c/span\u003e\u003cspan class=\"token directive keyword\"\u003einclude\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"string.h\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token macro property\"\u003e\u003cspan class=\"token directive-hash\"\u003e#\u003c/span\u003e\u003cspan class=\"token directive keyword\"\u003einclude\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"driver/gpio.h\"\u003c/span\u003e\u003c/span\u003e\n\n\n\u003cspan class=\"token keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eint\u003c/span\u003e RX_BUF_SIZE \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e1024\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token macro property\"\u003e\u003cspan class=\"token directive-hash\"\u003e#\u003c/span\u003e\u003cspan class=\"token directive keyword\"\u003edefine\u003c/span\u003e \u003cspan class=\"token macro-name\"\u003eTXD_PIN\u003c/span\u003e \u003cspan class=\"token expression\"\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eGPIO_NUM_1\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token macro property\"\u003e\u003cspan class=\"token directive-hash\"\u003e#\u003c/span\u003e\u003cspan class=\"token directive keyword\"\u003edefine\u003c/span\u003e \u003cspan class=\"token macro-name\"\u003eRXD_PIN\u003c/span\u003e \u003cspan class=\"token expression\"\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eGPIO_NUM_3\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e//Declaration d une structure pour le message\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003etypedef\u003c/span\u003e \u003cspan class=\"token keyword\"\u003estruct\u003c/span\u003e \n\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003cspan class=\"token class-name\"\u003euint8_t\u003c/span\u003e Type\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token class-name\"\u003euint8_t\u003c/span\u003e  Action\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token class-name\"\u003euint8_t\u003c/span\u003e RequestID\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token class-name\"\u003euint8_t\u003c/span\u003e PortID\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token class-name\"\u003euint32_t\u003c/span\u003e Amount\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token class-name\"\u003emessage_t\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\n\u003cspan class=\"token comment\"\u003e//Declaration des queues\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003estatic\u003c/span\u003e QueueHandle_t rx_queue \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token constant\"\u003eNULL\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003estatic\u003c/span\u003e QueueHandle_t tx_queue \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token constant\"\u003eNULL\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e//Declaration du HEADER pour verifier le bon etat de la communication\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token class-name\"\u003euint8_t\u003c/span\u003e HEADER\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token number\"\u003e0xCA\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e0xFE\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e0xCA\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e0xFE\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\n\n\n\u003cspan class=\"token keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"token function\"\u003einit\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003evoid\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token class-name\"\u003euart_config_t\u003c/span\u003e uart_config \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ebaud_rate \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e115200\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edata_bits \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e UART_DATA_8_BITS\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eparity \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e UART_PARITY_DISABLE\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003estop_bits \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e UART_STOP_BITS_1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eflow_ctrl \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e UART_HW_FLOWCTRL_DISABLE\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esource_clk \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e UART_SCLK_DEFAULT\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e// We won't use a buffer for sending data.\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003euart_driver_install\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eUART_NUM_0\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e RX_BUF_SIZE \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token constant\"\u003eNULL\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003euart_param_config\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eUART_NUM_0\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026#x26;\u003c/span\u003euart_config\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003euart_set_pin\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eUART_NUM_0\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e TXD_PIN\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e RXD_PIN\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e UART_PIN_NO_CHANGE\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e UART_PIN_NO_CHANGE\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \n    \u003cspan class=\"token comment\"\u003e//Initialisation des queues\u003c/span\u003e\n     rx_queue \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003exQueueCreate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e10\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003esizeof\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token class-name\"\u003euint32_t\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n     tx_queue\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token function\"\u003exQueueCreate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e10\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003esizeof\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token class-name\"\u003euint32_t\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\n\n\n\n\u003cspan class=\"token keyword\"\u003eint\u003c/span\u003e \u003cspan class=\"token function\"\u003esendData\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token keyword\"\u003echar\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e logName\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token keyword\"\u003echar\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e data\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eint\u003c/span\u003e len \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003estrlen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edata\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eint\u003c/span\u003e txBytes \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003euart_write_bytes\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eUART_NUM_0\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e data\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e len\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003eESP_LOGI\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003elogName\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"Wrote %d bytes\\n\\n\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e txBytes\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e txBytes\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"token keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"token function\"\u003etx_task\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003earg\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token keyword\"\u003echar\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003eTX_TASK_TAG \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"TX_TASK\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e////Allocation dynamique de la memoire pour les buffers de messages\u003c/span\u003e\n     \u003cspan class=\"token class-name\"\u003euint32_t\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003etransmit\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token class-name\"\u003euint32_t\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token function\"\u003emalloc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003esizeof\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token class-name\"\u003emessage_t\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \n      \u003cspan class=\"token class-name\"\u003euint8_t\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003eHeader\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token class-name\"\u003euint8_t\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token function\"\u003emalloc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token keyword\"\u003esizeof\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token class-name\"\u003euint8_t\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \n    \u003cspan class=\"token function\"\u003eesp_log_level_set\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eTX_TASK_TAG\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ESP_LOG_INFO\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ewhile\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \t\u003cspan class=\"token comment\"\u003e//Stockage du premier message sur la queue dans le buffer avant envoi\u003c/span\u003e\n    \t \u003cspan class=\"token function\"\u003exQueueReceive\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etx_queue\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003etransmit\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e1000\u003c/span\u003e \u003cspan class=\"token operator\"\u003e/\u003c/span\u003e portTICK_PERIOD_MS\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \t \n    \t \u003cspan class=\"token comment\"\u003e//Envoi du header\u003c/span\u003e\n    \t\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eint\u003c/span\u003e nb_transmitH\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token function\"\u003euart_write_bytes\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eUART_NUM_0\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e Header\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003esizeof\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eHeader\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \t\n    \t\u003cspan class=\"token function\"\u003evTaskDelay\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e2000\u003c/span\u003e \u003cspan class=\"token operator\"\u003e/\u003c/span\u003e portTICK_PERIOD_MS\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \t\n    \t\u003cspan class=\"token comment\"\u003e//Envoi du message\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eint\u003c/span\u003e nb_transmit\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token function\"\u003euart_write_bytes\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eUART_NUM_0\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e transmit\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003esizeof\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etransmit\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"token function\"\u003evTaskDelay\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e2000\u003c/span\u003e \u003cspan class=\"token operator\"\u003e/\u003c/span\u003e portTICK_PERIOD_MS\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \n    \u003cspan class=\"token comment\"\u003e//Liberation des buffers\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003efree\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etransmit\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003efree\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eHeader\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"token keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"token function\"\u003erx_task\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003earg\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\t\n    \u003cspan class=\"token keyword\"\u003eint\u003c/span\u003e i\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token keyword\"\u003echar\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003eRX_TASK_TAG \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"RX_TASK\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003eesp_log_level_set\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eRX_TASK_TAG\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ESP_LOG_INFO\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e//Allocation dynamique de la memoire pour les buffers de messages\u003c/span\u003e\n    \u003cspan class=\"token class-name\"\u003euint8_t\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e data \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token class-name\"\u003euint8_t\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token function\"\u003emalloc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eRX_BUF_SIZE\u003cspan class=\"token operator\"\u003e+\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token class-name\"\u003euint8_t\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003eR_Head\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token class-name\"\u003euint8_t\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token function\"\u003emalloc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token keyword\"\u003esizeof\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token class-name\"\u003euint8_t\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \n    \u003cspan class=\"token class-name\"\u003euint32_t\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003emessage\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token class-name\"\u003euint32_t\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token function\"\u003emalloc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token keyword\"\u003esizeof\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token class-name\"\u003euint32_t\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \n    \n    \u003cspan class=\"token keyword\"\u003ewhile\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eint\u003c/span\u003e rxBytes \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003euart_read_bytes\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eUART_NUM_0\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e data\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e RX_BUF_SIZE\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e1000\u003c/span\u003e \u003cspan class=\"token operator\"\u003e/\u003c/span\u003e portTICK_PERIOD_MS\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003erxBytes \u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n            data\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003erxBytes\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"token function\"\u003eESP_LOGI\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eRX_TASK_TAG\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"Read %d bytes: '%s'\\n\\n\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e rxBytes\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e data\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"token function\"\u003eESP_LOG_BUFFER_HEXDUMP\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eRX_TASK_TAG\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e data\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e rxBytes\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ESP_LOG_INFO\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n        \n        \u003cspan class=\"token comment\"\u003e//Reception du header\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eint\u003c/span\u003e nb_bitH\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token function\"\u003euart_read_bytes\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eUART_NUM_0\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e R_Head\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token keyword\"\u003esizeof\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token class-name\"\u003euint8_t\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e1000\u003c/span\u003e \u003cspan class=\"token operator\"\u003e/\u003c/span\u003e portTICK_PERIOD_MS\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \n        \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003enb_bitH\u003cspan class=\"token operator\"\u003e==\u003c/span\u003e\u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \t\u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ei\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003ei\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003enb_bitH\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003ei\u003cspan class=\"token operator\"\u003e++\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \t\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e        \t\n        \t\t\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eR_Head\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!=\u003c/span\u003eHEADER\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \t\t\t\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \t\t\t\u003cspan class=\"token function\"\u003eprintf\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Wrong Header ! Communication Failed !\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \t\t\t\u003cspan class=\"token keyword\"\u003ebreak\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\t\n        \t\t\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n        \t        \t        \t\t\n        \t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n        \t       \n        \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n        \n        \u003cspan class=\"token comment\"\u003e//Reception du message et stockage dans la queue        \u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eint\u003c/span\u003e nb_bitM\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token function\"\u003euart_read_bytes\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eUART_NUM_0\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e message\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003esizeof\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token class-name\"\u003emessage_t\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e1000\u003c/span\u003e \u003cspan class=\"token operator\"\u003e/\u003c/span\u003e portTICK_PERIOD_MS\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"token function\"\u003exQueueSend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003erx_queue\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003emessage\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e1000\u003c/span\u003e \u003cspan class=\"token operator\"\u003e/\u003c/span\u003e portTICK_PERIOD_MS\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \n      \n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e// Liberation des buffers\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003efree\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edata\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003efree\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eR_Head\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003efree\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emessage\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\n\u003cspan class=\"token keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"token keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"token function\"\u003ebank_task\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003earg\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eint\u003c/span\u003e balance\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e//Solde du compte\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token keyword\"\u003echar\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003eTX_TASK_TAG \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"TX_TASK\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003eesp_log_level_set\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eTX_TASK_TAG\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ESP_LOG_INFO\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ewhile\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token function\"\u003esendData\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eTX_TASK_TAG\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"Hello world\\n\\n\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"token function\"\u003evTaskDelay\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e2000\u003c/span\u003e \u003cspan class=\"token operator\"\u003e/\u003c/span\u003e portTICK_PERIOD_MS\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\n\u003cspan class=\"token keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"token function\"\u003eapp_main\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003evoid\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003einit\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003exTaskCreate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003erx_task\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"uart_rx_task\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e1024\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token constant\"\u003eNULL\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e configMAX_PRIORITIES\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token constant\"\u003eNULL\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003exTaskCreate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etx_task\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"uart_tx_task\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e1024\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token constant\"\u003eNULL\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e configMAX_PRIORITIES\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token constant\"\u003eNULL\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003exTaskCreate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ebank_task\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"bank_task\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e1024\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token constant\"\u003eNULL\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e configMAX_PRIORITIES\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token constant\"\u003eNULL\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"our-python-code\"\u003eOur Python Code\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#our-python-code\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cpre class=\"language-python\"\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"token comment\"\u003e# -------------------------------------------- #\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# Class Client                                 #\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# Tasks:                                       #\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# - emit serial messages to the ESP card       #\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# - receive serial messages from the ESP card  #\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# -------------------------------------------- #\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# This module encapsulates the access for the serial port.\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e serial\n\u003cspan class=\"token comment\"\u003e# This module converts between Python values and C structs\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# represented as Python bytes objects.\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e struct \u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eclient\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e# initializing values and properties of objects\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003e__init__\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eself\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e st_type\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e st_cid\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e st_rid\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e st_operation\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e st_ammount\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eNone\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        self\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003est_type \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e st_type              \u003cspan class=\"token comment\"\u003e# 0 or 1 w.r.t. being resp. REQUEST or RESPONSE\u003c/span\u003e\n        self\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003est_cid \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e st_cid                \u003cspan class=\"token comment\"\u003e# 0 .. 255 identification number for the client\u003c/span\u003e\n        self\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003est_rid \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e st_rid                \u003cspan class=\"token comment\"\u003e# 0 .. 255 identification number for the request\u003c/span\u003e\n        self\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003est_operation \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e st_operation    \u003cspan class=\"token comment\"\u003e# 0 or 1 w.r.t. being resp. withdraw or deposit\u003c/span\u003e\n        self\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003est_ammount \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e st_ammount        \u003cspan class=\"token comment\"\u003e# positive integer for the ammount \u003c/span\u003e\n    \n    \u003cspan class=\"token comment\"\u003e# method structurizing the message with struct.pack\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003estructurer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eself\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token builtin\"\u003ebytes\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        st \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e struct\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003epack\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"\u0026#x3C;IIIQ\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e self\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003est_type\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e self\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003est_cid\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e self\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003est_rid\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e self\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003est_operation\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e self\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003est_ammount\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \n        \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e st\n    \n    \u003cspan class=\"token comment\"\u003e# method sending a message throw the serial port\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003esend_message\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eself\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eNone\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        ser \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e serial\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eSerial\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'/dev/ttyUSB0'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token comment\"\u003e# open serial port\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eser\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ename\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e                     \u003cspan class=\"token comment\"\u003e# check which port was really used\u003c/span\u003e\n        ser\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ewrite\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eself\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003estructurer\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eself\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e    \u003cspan class=\"token comment\"\u003e# write a string\u003c/span\u003e\n        ser\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eclose\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e                         \u003cspan class=\"token comment\"\u003e# close port\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003cstrong\u003eBacklinks\u003c/strong\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/UT3-AURO-2223-S10-Dendron/notes/zlr2s0g64dtr3njuzx1iylh\"\u003eSATR - Systèmes et Architectures Temps Réels\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","noteIndex":{"id":"wn8PE1RhG0znK1alrGFYv","title":"Portail Digital du M2 AURO 2022/2023 de RKA","desc":"","updated":1669033598588,"created":1631901573363,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault"},"contentHash":"4d5454b71088c3c74fdb20ab3ed32dab","links":[],"anchors":{"idée":{"type":"header","text":"Idée","value":"idée","line":11,"column":0,"depth":1},"liens-utiles":{"type":"header","text":"Liens utiles","value":"liens-utiles","line":17,"column":0,"depth":1},"remerciement":{"type":"header","text":"Remerciement","value":"remerciement","line":28,"column":0,"depth":1},"contact":{"type":"header","text":"Contact","value":"contact","line":36,"column":0,"depth":1}},"children":["wmc6wolqmlygiqlfcwihsso","43j78t90ywskb5ji2dl1dv6","wifhrlf5o1cm74d5nvmwtmd","g54kxj2u0t1wl4x6uo6vgbt","90wm5tdnz2dnqs3098ttvor"],"parent":null,"data":{},"body":"\n\u003e **Avertissement:**\nCette page peut contenir des fautes ! Envoyez-moi un message sur [`#UT3-AURO-M2-2223-Request:matrix.org`](https://matrix.to/#/#UT3-AURO-M2-2223-Request:matrix.org) si vous en trouvez, merci.\n\n# Idée\n\nCe projet a pour but de regrouper mes notes de cours en utilisant les outils offerts par [Dendron](dendron.so) pour structurer et hiérarchiser l'information.\n\nDe cette façon, ce portail devient un \"one-stop-shop\" pour accéder et/ou retrouver les connaissances acquises durant le master.\n\n# Liens utiles\n\nPour plus d'informations:\n- [Lien officiel du Master AURO de l'Université Paul Sabatier](https://www.univ-tlse3.fr/master-parcours-automatique-et-robotique-auro)\n- [Lien vers la page moodle des cours](https://moodle.univ-tlse3.fr/course/index.php?categoryid=1269)\n- [Dendron Official Website](dendron.so)\n- [Dendron Wiki](https://wiki.dendron.so/)\n- [Dendron's Discord](https://discord.com/invite/xrKTUStHNZ)\n\n\n\n# Remerciement\n\nUn grand merci à GEA pour avoir mis à disposition les scans de ses notes !\n\nJe tiens aussi à remercier mes enseignants pour m'autoriser à prendre en photo les tableaux.\n\nLastly, a big thank you to everyone in [Dendron](dendron.so)'s team and the community for all their support.\n\n# Contact\n\nUn salon [Element](https://element.io/) est mis à disposition des lecteurs pour toutes questions/sugesstions ou pour faire remonter des erreurs/typos.\n\n\n[`#UT3-AURO-M2-2223-Request:matrix.org`](https://matrix.to/#/#UT3-AURO-M2-2223-Request:matrix.org)\n\n---\n\n\u003e This website has been generated using [Dendron](dendron.so) and [GitHub Actions](https://github.com/features/actions).\n\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":false,"leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2,"vaultSelectionModeOnCreate":"smart"}},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"randomNote":{},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":"vault"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"maxPreviewsCached":10,"maxNoteLength":204800,"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"enableUserTags":true,"enableHashTags":true,"dendronVersion":"0.95.0","enableEditorDecorations":true,"enableFullHierarchyNoteTitle":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false,"enableFrontmatterTags":true,"enableHashesForFMTags":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Dendron","description":"Personal knowledge space"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"lookup","enableMermaid":true,"assetsPrefix":"/UT3-AURO-2223-S10-Dendron","siteUrl":"https://tunnark.github.io","duplicateNoteBehavior":{"action":"useVault","payload":["vault"]},"theme":"dark","siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"t9wkuehbrl7iknmi1um2po3"},"buildId":"zHaMehK8gqkJYPwoajrMO","assetPrefix":"/UT3-AURO-2223-S10-Dendron","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>