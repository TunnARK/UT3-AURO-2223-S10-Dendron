{"pageProps":{"note":{"id":"t9wkuehbrl7iknmi1um2po3","title":"TP1 - RTOS/ESP-IDF","desc":"","updated":1673197018549,"created":1669371857862,"custom":{},"fname":"B2.SATR.TP1","type":"note","vault":{"fsPath":"vault"},"contentHash":"00609aca3e347460342ba1b73ebd6c5b","links":[{"from":{"fname":"B2.SATR","id":"zlr2s0g64dtr3njuzx1iylh","vaultName":"vault"},"type":"backlink","position":{"start":{"line":26,"column":3,"offset":428},"end":{"line":26,"column":18,"offset":443},"indent":[]},"value":"B2.SATR.TP1"}],"anchors":{"préparation-du-tp":{"type":"header","text":"Préparation du TP","value":"préparation-du-tp","line":10,"column":0,"depth":1},"prérequisinstallations":{"type":"header","text":"Prérequis/Installations","value":"prérequisinstallations","line":23,"column":0,"depth":1},"slide":{"type":"header","text":"Slide","value":"slide","line":31,"column":0,"depth":1},"this-presentation":{"type":"header","text":"This Presentation","value":"this-presentation","line":35,"column":0,"depth":2},"freertos":{"type":"header","text":"FreeRTOS","value":"freertos","line":40,"column":0,"depth":2},"esp-idf":{"type":"header","text":"ESP-IDF","value":"esp-idf","line":44,"column":0,"depth":2},"hello-world":{"type":"header","text":"Hello World","value":"hello-world","line":48,"column":0,"depth":2},"generic-gpio":{"type":"header","text":"Generic GPIO","value":"generic-gpio","line":52,"column":0,"depth":2},"bank-server":{"type":"header","text":"Bank: Server","value":"bank-server","line":55,"column":0,"depth":2},"bank-uart":{"type":"header","text":"Bank: UART","value":"bank-uart","line":59,"column":0,"depth":2},"messages":{"type":"header","text":"Messages","value":"messages","line":63,"column":0,"depth":2},"queues":{"type":"header","text":"Queues","value":"queues","line":67,"column":0,"depth":2},"tasks":{"type":"header","text":"Tasks","value":"tasks","line":71,"column":0,"depth":2},"rx-task":{"type":"header","text":"Rx Task","value":"rx-task","line":75,"column":0,"depth":2},"bank-task":{"type":"header","text":"Bank Task","value":"bank-task","line":79,"column":0,"depth":2},"tx-task":{"type":"header","text":"Tx Task","value":"tx-task","line":83,"column":0,"depth":2},"client":{"type":"header","text":"Client","value":"client","line":87,"column":0,"depth":2},"suppléments":{"type":"header","text":"Suppléments","value":"suppléments","line":92,"column":0,"depth":1},"code-c":{"type":"header","text":"Code C","value":"code-c","line":94,"column":0,"depth":2},"python":{"type":"header","text":"Python","value":"python","line":133,"column":0,"depth":2},"interruptions":{"type":"header","text":"Interruptions","value":"interruptions","line":141,"column":0,"depth":2},"gpio":{"type":"header","text":"GPIO","value":"gpio","line":143,"column":0,"depth":3},"uart---universal-asynchronus-receivertransmitter":{"type":"header","text":"UART - Universal Asynchronus Receiver/Transmitter","value":"uart---universal-asynchronus-receivertransmitter","line":166,"column":0,"depth":2},"messages-1":{"type":"header","text":"Messages","value":"messages-1","line":185,"column":0,"depth":3},"files-dattentes":{"type":"header","text":"Files d'attentes","value":"files-dattentes","line":223,"column":0,"depth":3},"priorités":{"type":"header","text":"Priorités","value":"priorités","line":232,"column":0,"depth":3},"test-unitaire":{"type":"header","text":"Test Unitaire","value":"test-unitaire","line":239,"column":0,"depth":2},"compte-rendu-de-tp-du-20221130":{"type":"header","text":"Compte Rendu de TP du 2022/11/30","value":"compte-rendu-de-tp-du-20221130","line":243,"column":0,"depth":1},"hello-world-1":{"type":"header","text":"Hello World","value":"hello-world-1","line":245,"column":0,"depth":2},"generic-gpio-1":{"type":"header","text":"Generic GPIO","value":"generic-gpio-1","line":256,"column":0,"depth":2},"compte-rendu-de-tp-du-20221209":{"type":"header","text":"Compte Rendu de TP du 2022/12/09","value":"compte-rendu-de-tp-du-20221209","line":266,"column":0,"depth":1},"sys-emb":{"type":"header","text":"Sys. Emb.","value":"sys-emb","line":268,"column":0,"depth":2},"liens-utiles":{"type":"header","text":"Liens utiles","value":"liens-utiles","line":270,"column":0,"depth":3},"booting":{"type":"header","text":"Booting","value":"booting","line":275,"column":0,"depth":3},"configuration-des-ports":{"type":"header","text":"Configuration des ports","value":"configuration-des-ports","line":285,"column":0,"depth":3},"codage":{"type":"header","text":"Codage","value":"codage","line":296,"column":0,"depth":3},"python-1":{"type":"header","text":"Python","value":"python-1","line":301,"column":0,"depth":2},"objectif":{"type":"header","text":"Objectif","value":"objectif","line":303,"column":0,"depth":3},"module-recommandé":{"type":"header","text":"Module recommandé","value":"module-recommandé","line":310,"column":0,"depth":3},"creation-dune-interface":{"type":"header","text":"Creation d'une interface","value":"creation-dune-interface","line":314,"column":0,"depth":3},"class-client":{"type":"header","text":"Class Client","value":"class-client","line":318,"column":0,"depth":3},"class-message":{"type":"header","text":"Class Message","value":"class-message","line":323,"column":0,"depth":3},"testings-on-20230108":{"type":"header","text":"Testings on 2023/01/08","value":"testings-on-20230108","line":327,"column":0,"depth":1},"coding-on-esp32":{"type":"header","text":"Coding on ESP32","value":"coding-on-esp32","line":329,"column":0,"depth":2},"how-to-run-the-code":{"type":"header","text":"How to run the code","value":"how-to-run-the-code","line":331,"column":0,"depth":3},"results":{"type":"header","text":"Results","value":"results","line":345,"column":0,"depth":3},"our-mainc":{"type":"header","text":"Our main.c","value":"our-mainc","line":446,"column":0,"depth":3},"our-python-code":{"type":"header","text":"Our Python Code","value":"our-python-code","line":619,"column":0,"depth":2}},"children":[],"parent":"zlr2s0g64dtr3njuzx1iylh","data":{}},"body":"<h1 id=\"tp1---rtosesp-idf\">TP1 - RTOS/ESP-IDF<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#tp1---rtosesp-idf\"></a></h1>\n<p>More information on the github repo: <a href=\"https://github.com/TunnARK/UT3-AURO-2223-S10-Coding/tree/master/SATR-TP1-ESPBank\">SATR-TP1-ESPBank</a></p>\n<h1 id=\"préparation-du-tp\">Préparation du TP<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#préparation-du-tp\"></a></h1>\n<p>Se familiariser avec :</p>\n<ul>\n<li>\n<p><a href=\"https://freertos.org/taskandcr.html\">FreeRTOS - Tasks and Co-Routines</a></p>\n<p>  --> API Reference > Task Creation</p>\n<ul>\n<li>vsStackDepth</li>\n<li>vTaskDelay</li>\n<li>xTaskCreate</li>\n<li>vTaskSuspend</li>\n</ul>\n</li>\n<li>\n<p><a href=\"https://github.com/espressif/esp-idf/tree/master/examples\">les exemples d'esp-idf</a></p>\n</li>\n</ul>\n<h1 id=\"prérequisinstallations\">Prérequis/Installations<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#prérequisinstallations\"></a></h1>\n<p>Installer ESP-IDF et suivre le <code>Get Started</code>:</p>\n<ul>\n<li><a href=\"/UT3-AURO-2223-S10-Dendron/github.com/espressif/esp-idf\">Repo GitHub ESP-IDF</a></li>\n<li><a href=\"https://docs.espressif.com/projects/esp-idf/en/latest/esp32/get-started/linux-macos-setup.html\">Docs - Get-Started: Manual Install (linux-macos)</a></li>\n</ul>\n<blockquote>\n<p>Possibilité d'utiliser VS Code</p>\n</blockquote>\n<h1 id=\"slide\">Slide<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#slide\"></a></h1>\n<p><img src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-01.png\"></p>\n<h2 id=\"this-presentation\">This Presentation<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#this-presentation\"></a></h2>\n<p><img src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-02.png\">\n<img src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-03.png\"></p>\n<h2 id=\"freertos\">FreeRTOS<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#freertos\"></a></h2>\n<p><img src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-04.png\"></p>\n<h2 id=\"esp-idf\">ESP-IDF<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#esp-idf\"></a></h2>\n<p><img src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-05.png\"></p>\n<h2 id=\"hello-world\">Hello World<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#hello-world\"></a></h2>\n<p><img src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-06.png\"></p>\n<h2 id=\"generic-gpio\">Generic GPIO<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#generic-gpio\"></a></h2>\n<p><img src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-07.png\"></p>\n<h2 id=\"bank-server\">Bank: Server<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#bank-server\"></a></h2>\n<p><img src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-08.png\"></p>\n<h2 id=\"bank-uart\">Bank: UART<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#bank-uart\"></a></h2>\n<p><img src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-09.png\"></p>\n<h2 id=\"messages\">Messages<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#messages\"></a></h2>\n<p><img src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-10.png\"></p>\n<h2 id=\"queues\">Queues<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#queues\"></a></h2>\n<p><img src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-11.png\"></p>\n<h2 id=\"tasks\">Tasks<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#tasks\"></a></h2>\n<p><img src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-12.png\"></p>\n<h2 id=\"rx-task\">Rx Task<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#rx-task\"></a></h2>\n<p><img src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-13.png\"></p>\n<h2 id=\"bank-task\">Bank Task<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#bank-task\"></a></h2>\n<p><img src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-14.png\"></p>\n<h2 id=\"tx-task\">Tx Task<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#tx-task\"></a></h2>\n<p><img src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-15.png\"></p>\n<h2 id=\"client\">Client<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#client\"></a></h2>\n<p><img src=\"/UT3-AURO-2223-S10-Dendron/assets/images/B2.SATR.TP1.RTOSESPIDF-16.png\"></p>\n<h1 id=\"suppléments\">Suppléments<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#suppléments\"></a></h1>\n<h2 id=\"code-c\">Code C<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#code-c\"></a></h2>\n<blockquote>\n<p>Pour de l'embarquer le RUST est plus robuste que le C</p>\n</blockquote>\n<p><a href=\"http://cliffle.com/blog/not-thread-safe/#the-bank-account-example\">Le code à utiliser ici :</a></p>\n<pre class=\"language-c++\"><code class=\"language-c++\">/*\n * Stores information about a bank account.\n */\nstruct bank_account {\n    /* How much money is in the account. */\n    int balance; /* never use floats for managing money (too much approximation) */\n};\n\n/*\n * Deposits 'amt' into the 'account' and returns the new balance.\n */\nint deposit(struct bank_account *account, int amt) {\n    account->balance += amt;\n    return account->balance;\n}\n\n/*\n * Tries to withdraw 'amt' from the account. Returns 'true' if it\n * succeeded, 'false' if the account didn't contain enough.\n */\nbool withdraw(struct bank_account *account, int amt) {\n    if (account->balance >= amt) {\n        account->balance -= amt;\n        return true;\n    } else {\n        return false;\n    }\n}\n</code></pre>\n<p>Remarque:</p>\n<ul>\n<li>pour connaitre l'état du compte il suffit de faire <code>deposit(0)</code> est la fct retournera ce qui reste dans le compte</li>\n</ul>\n<h2 id=\"python\">Python<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#python\"></a></h2>\n<pre class=\"language-python\"><code class=\"language-Python\"><span class=\"token keyword\">def</span> <span class=\"token function\">deposit</span><span class=\"token punctuation\">(</span>amt <span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">int</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">withdraw</span><span class=\"token punctuation\">(</span>amt <span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">int</span>\n</code></pre>\n<h2 id=\"interruptions\">Interruptions<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#interruptions\"></a></h2>\n<h3 id=\"gpio\">GPIO<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#gpio\"></a></h3>\n<p>Le code de gestion des interruptions<code>~/esp/generic_gpio/main/gpio_example_main.c</code></p>\n<pre class=\"language-c\"><code class=\"language-C\"><span class=\"token keyword\">static</span> QueueHandle_t gpio_evt_queue <span class=\"token operator\">=</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> IRAM_ATTR <span class=\"token function\">gpio_isr_handler</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token operator\">*</span> arg<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">uint32_t</span> gpio_num <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span><span class=\"token punctuation\">)</span> arg<span class=\"token punctuation\">;</span>\n    <span class=\"token function\">xQueueSendFromISR</span><span class=\"token punctuation\">(</span>gpio_evt_queue<span class=\"token punctuation\">,</span> <span class=\"token operator\">&#x26;</span>gpio_num<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">gpio_task_example</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token operator\">*</span> arg<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">uint32_t</span> io_num<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">xQueueReceive</span><span class=\"token punctuation\">(</span>gpio_evt_queue<span class=\"token punctuation\">,</span> <span class=\"token operator\">&#x26;</span>io_num<span class=\"token punctuation\">,</span> portMAX_DELAY<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"GPIO[%\"</span>PRIu32<span class=\"token string\">\"] intr, val: %d\\n\"</span><span class=\"token punctuation\">,</span> io_num<span class=\"token punctuation\">,</span> <span class=\"token function\">gpio_get_level</span><span class=\"token punctuation\">(</span>io_num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<h2 id=\"uart---universal-asynchronus-receivertransmitter\">UART - Universal Asynchronus Receiver/Transmitter<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#uart---universal-asynchronus-receivertransmitter\"></a></h2>\n<ul>\n<li><a href=\"https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/peripherals/uart.html\">lien vers la doc UART</a></li>\n<li>Un UART n'est pas un bus temps réel\nbuffer entre le code et les files om gere pas ca</li>\n<li>Chaque UART a sa propre horloge (dans le cas d'un USRT (synchronus) on rajoute une clock de référence)</li>\n<li>equivalence reseau: 2eme couche du modele OSI donc similaire a une tram avec son protocle</li>\n</ul>\n<!--8 data graph-->\n<!-- ![](/assets/images/B2.SATR.TP1.RTOSESPIDF.NotesGEA-01.png) -->\n<!-- ![](/assets/images/B2.SATR.TP1.RTOSESPIDF.NotesGEA-02.png) -->\n<!-- ![](/assets/images/B2.SATR.TP1.RTOSESPIDF.NotesGEA-03.png) -->\n<p>ATTETNION: </p>\n<ul>\n<li>le pc est en 64 bit mais l'ESP32 est sur du 32 bit donc la taille d'un <code>int</code> n'est pas la meme</li>\n<li>cepedant avec un <code>int</code> en 32 bit on peut gérer jusqu'à 40 millions d'euros i.e. <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mo>∗</mo><mn>32</mn><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">/</mi><mn>100</mn><mo>=</mo><mn>42</mn><mtext>  </mtext><mi>m</mi><mi>i</mi><mi>l</mi><mi>l</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">(2*32-1)/100=42\\;millions</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">32</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mord\">/100</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord\">42</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\">mi</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">ll</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">s</span></span></span></span></span></li>\n</ul>\n<h3 id=\"messages-1\">Messages<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#messages-1\"></a></h3>\n<p>Ces messages devront prendre en compte :</p>\n<ul>\n<li>Header: [OxCA,OxFE,OxCA,OxFE]</li>\n<li>type: REQ/REP</li>\n<li>Client ID</li>\n<li>Req ID</li>\n<li>Operation</li>\n<li>Ammount (32 bit int)</li>\n</ul>\n<p>Exemple:</p>\n<ul>\n<li>1 client et 1 serveur pour le moment</li>\n<li>le client fait une requete:\n<ul>\n<li><code>M1(type=REQ, CID=1, RID=1, Amount=100, Op=1)</code></li>\n</ul>\n</li>\n<li>Il recoit alors la réponse:\n<ul>\n<li><code>M1(type=REP, CID=1, RID=1, Amount=200, Op=1)</code></li>\n</ul>\n</li>\n<li>On remarque alors qu'il peut y avoir un probleme avec ce jeu de parametres car on ne sait pas comment gérer l'absence et l'attente de réponse --> introduire du coup un param <code>time out</code> de 1 sec</li>\n<li>Autre soucis c'est la synchronisation des canaux --> ajouter un <code>HEADER</code>\n<ul>\n<li>une autre option aurait été de faire un <code>3handshake</code> (soit <code>Sync>Sync/Ack>Ack</code>)</li>\n</ul>\n</li>\n<li>Du coup on reprend l'échange précédant avec le header, on envoit dans l'ordre :\n<ol>\n<li>4 oct(s): Header</li>\n<li>1 oct(s): Type</li>\n<li>1 oct(s): Client ID (ou mieux un <strong>numéro de port</strong> ! attention ceci est valide si il n'y a pas de bus commun entre les pc)</li>\n<li>1 oct(s): Req ID \n<ul>\n<li>ici peut etre 1 oct suffit pas mais en vrai avec 1 oct on doit avoir plus de 256 requetes non répondus en moins d'une seconde donc ça ira</li>\n</ul>\n</li>\n<li>1 oct(s): Operation</li>\n<li>4 oct(s): Amount</li>\n</ol>\n</li>\n<li>Une autre organisation plus optimale niveau mémoire et temps d'envoi/recpetion (mais cela rend la programmation plus risquée lors de la conception du coup on va plustot préférencer l'option précédente)\n<ol>\n<li>4 oct(s): Header</li>\n<li>1 oct(s): Type + Operation</li>\n<li>1 oct(s): Client ID</li>\n<li>1 oct(s): Req ID</li>\n<li>4 oct(s): Amount</li>\n</ol>\n</li>\n</ul>\n<!-- Un exemple de séquence de message : -->\n<!-- ![](/assets/images/B2.SATR.TP1.RTOSESPIDF.NotesGEA-04.png) -->\n<ul>\n<li>La configuration python avec <code>dep/withdraw/tx/rx</code> ne permettra pas d'envoyer plusieurs requetes en meme temps car les fcts <code>dep</code> et <code>with</code> appel <code>tx</code> et <code>rx</code> (si on a le temps on verra comment gerer de l'asynchrone en python)</li>\n</ul>\n<h3 id=\"files-dattentes\">Files d'attentes<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#files-dattentes\"></a></h3>\n<p>On crée un pointeur contenant toute les files d'attentes (<code>Rx</code>,<code>Tx1</code>, <code>Tx2</code>, <code>Tx3</code>, ...).</p>\n<p>Chaque files nécessite une capacité (nombre de requete qu'elle contient ici 10) et d'une taille pour chaque requete</p>\n<pre class=\"language-c\"><code class=\"language-C\"><span class=\"token comment\">//create a queue to handle gpio event from isr</span>\n    gpio_evt_queue <span class=\"token operator\">=</span> <span class=\"token function\">xQueueCreate</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h3 id=\"priorités\">Priorités<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#priorités\"></a></h3>\n<p>Maintenant quelles priorités données aux tâches, il y a 3 philosophies :</p>\n<ul>\n<li>Back Pressure: donner la prior. à Tx pour eviter des bottle neck</li>\n<li>Conservative : donner la prior. à Rx pour ne pas perdre de donner</li>\n<li>Fairly: donner la priorité à la tache la plus solicité ici bank puisque qu'il a 3 copie de Tx/Rx qui l'appelle</li>\n</ul>\n<h2 id=\"test-unitaire\">Test Unitaire<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#test-unitaire\"></a></h2>\n<p>TDD - Test Driver Development</p>\n<h1 id=\"compte-rendu-de-tp-du-20221130\">Compte Rendu de TP du 2022/11/30<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#compte-rendu-de-tp-du-20221130\"></a></h1>\n<h2 id=\"hello-world-1\">Hello World<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#hello-world-1\"></a></h2>\n<ol>\n<li>Suivre le <a href=\"https://docs.espressif.com/projects/esp-idf/en/latest/esp32/get-started/linux-macos-setup.html#\">guide d'installation</a> jusqu'à l'étape <code>Configure Your Project</code> (etape exclue).</li>\n<li>Ignorer cette étape, mais à la place modifier le fichier <code>/workspace/esp/hello_world/sdkconfig</code> pour reconfigurer la fréquence de <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>40</mn><mi>M</mi><mi>H</mi><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">40MHz</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">40</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">Hz</span></span></span></span></span> à <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>26</mn><mi>M</mi><mi>H</mi><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">26MHz</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">26</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">Hz</span></span></span></span></span> (cf slide 6 pour plus d'info).</li>\n<li>Continuer les étapes restantes du <a href=\"https://docs.espressif.com/projects/esp-idf/en/latest/esp32/get-started/linux-macos-setup.html#\">guide d'installation</a>\n<ul>\n<li>Une fois le <code>Build Project</code> terminé, lancer le flash</li>\n<li>Si vous recevez une erreur du style \"port introuvalbe\", s'assurer que la session utilisateur a acces au groupe\n<ol>\n<li><code>ll \\dev\\ttyUSB0</code> (ou <code>ll \\dev\\PORT</code>) pour connaitre les droits d'accès du port</li>\n<li><code>sudo usermod -aG GROUP USERNAME</code> pour ajouter un user dans un groupe</li>\n<li><code>groups</code> ne se met pas à jour directement (visuellement) donc faire <code>newgrp GROUP</code> pour mettre à jour le groupe et relancer <code>groups</code> pour lister les utilisateurs (vérifier que l'utilisateur ajouter et bien présent).</li>\n</ol>\n</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"generic-gpio-1\">Generic GPIO<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#generic-gpio-1\"></a></h2>\n<ol>\n<li>Se placer dans le workspace (ici <code>/esp/</code>) et copier-coller le dossier exemple gpio <code>cp -r $IDF_PATH/examples/peripherals/gpio/generic_gpio .</code></li>\n<li>Se placer dans <code>/workspace/generic_gpio</code> et lancer <code>idf.py set-target esp32</code></li>\n<li>Modifier le fichier <code>/workspace/generic_gpio/sdkconfig</code> pour reconfigurer la fréquence de <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>40</mn><mi>M</mi><mi>H</mi><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">40MHz</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">40</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">Hz</span></span></span></span></span> à <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>26</mn><mi>M</mi><mi>H</mi><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">26MHz</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">26</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">Hz</span></span></span></span></span> (cf slide 7 pour plus d'info).</li>\n<li>Lancer le build <code>idf.py build</code></li>\n<li>Flasher la carte <code>idf.py flash</code> (ou <code>idf.py -p PORT flash</code>)</li>\n<li>Le code est déjà en train de s'exécuter en background pour le voir lancer <code>idf.py monitor</code> (ou <code>idf.py -p PORT monitor</code>)</li>\n<li>Se familiariser avec le code de communication <code>/workspace/generic_gpio/main/</code></li>\n</ol>\n<h1 id=\"compte-rendu-de-tp-du-20221209\">Compte Rendu de TP du 2022/12/09<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#compte-rendu-de-tp-du-20221209\"></a></h1>\n<h2 id=\"sys-emb\">Sys. Emb.<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#sys-emb\"></a></h2>\n<h3 id=\"liens-utiles\">Liens utiles<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#liens-utiles\"></a></h3>\n<ul>\n<li><a href=\"https://docs.espressif.com/projects/esp-idf/en/latest/esp32/get-started/index.html#\">Get Started</a></li>\n<li><a href=\"https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/peripherals/uart.html\">Docs UART</a></li>\n</ul>\n<h3 id=\"booting\">Booting<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#booting\"></a></h3>\n<ol>\n<li>Se placer dans le workspace (ici <code>/esp/</code>) et copier-coller le dossier exemple gpio\n<code>cp -r /esp/esp-idf/examples/peripherals/uart/uart_async_rxtxtasks/ .</code></li>\n<li>Se placer dans <code>/workspace/uart_async_rxtxtasks</code> et lancer <code>idf.py set-target esp32</code></li>\n<li>Modifier le fichier <code>/workspace/uart_async_rxtxtasks/sdkconfig</code> pour reconfigurer la fréquence de <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>40</mn><mi>M</mi><mi>H</mi><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">40MHz</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">40</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">Hz</span></span></span></span></span> à <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>26</mn><mi>M</mi><mi>H</mi><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">26MHz</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">26</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">Hz</span></span></span></span></span> (cf slide 7 pour plus d'info).</li>\n<li>Lancer le build <code>idf.py build</code></li>\n<li>Flasher la carte <code>idf.py flash</code> (ou <code>idf.py -p PORT flash</code>)</li>\n<li>Le code est déjà en train de s'exécuter en background pour le voir lancer <code>idf.py monitor</code> (ou <code>idf.py -p PORT monitor</code>)</li>\n</ol>\n<h3 id=\"configuration-des-ports\">Configuration des ports<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#configuration-des-ports\"></a></h3>\n<ol>\n<li>Ouvrir le fichier <code>main/uart_async_rxtxtasks_main.c</code></li>\n<li>Modifier les ports par défaut par :\n<ul>\n<li>\n<pre class=\"language-c\"><code class=\"language-C\">  <span class=\"token comment\">// Dans /main/uart_async_rxtxtasks_main.c</span>\n  <span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">TXD_PIN</span> <span class=\"token expression\"><span class=\"token punctuation\">(</span>GPIO_NUM_1<span class=\"token punctuation\">)</span></span></span>\n  <span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">RXD_PIN</span> <span class=\"token expression\"><span class=\"token punctuation\">(</span>GPIO_NUM_3<span class=\"token punctuation\">)</span></span></span>\n</code></pre>\n</li>\n</ul>\n</li>\n<li>De plus, remplacer dans ce code toute apparition de <code>UART_NUM_1</code> par <code>UART_NUM_0</code></li>\n</ol>\n<h3 id=\"codage\">Codage<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#codage\"></a></h3>\n<h2 id=\"python-1\">Python<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#python-1\"></a></h2>\n<h3 id=\"objectif\">Objectif<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#objectif\"></a></h3>\n<p>Créer un code python pour instancier et visualiser les fonctionnalités du projet Bank</p>\n<pre><code>- une fonciton `Création/Suppression` de compte bancaire\n- une fonction `Deposit`\n- une fonction `Withdraw`\n</code></pre>\n<h3 id=\"module-recommandé\">Module recommandé<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#module-recommandé\"></a></h3>\n<p>Module <code>struct</code>, <code>bserial</code></p>\n<h3 id=\"creation-dune-interface\">Creation d'une interface<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#creation-dune-interface\"></a></h3>\n<p>Lien Utile: <a href=\"https://www.cours-gratuit.com/tutoriel-python/tutoriel-python-programmer-une-interface-graphique-avec-tkinter-partie-1#_Toc52998640\">Interface Python avec Tkinter</a></p>\n<h3 id=\"class-client\">Class Client<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#class-client\"></a></h3>\n<ul>\n<li>sur python le typage est dynamic donc le type est assigné selon ce qui arrive</li>\n<li>le header n'est pas a mettre dans le struct.pack car il précéde le message</li>\n</ul>\n<h3 id=\"class-message\">Class Message<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#class-message\"></a></h3>\n<p>class message</p>\n<h1 id=\"testings-on-20230108\">Testings on 2023/01/08<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#testings-on-20230108\"></a></h1>\n<h2 id=\"coding-on-esp32\">Coding on ESP32<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#coding-on-esp32\"></a></h2>\n<h3 id=\"how-to-run-the-code\">How to run the code<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#how-to-run-the-code\"></a></h3>\n<ol>\n<li>Open New Terminal </li>\n<li>Install Environment\n<ul>\n<li><code>cd /workspace/esp-idf/</code></li>\n<li><code>./install.sh esp32</code></li>\n<li><code>. ./export.sh</code></li>\n</ul>\n</li>\n<li>Sett up UART Environment\n<ul>\n<li><code>cd /workspace/uart_async_rxtxtasks/</code></li>\n<li><code>idf.py set-target esp32</code></li>\n<li><code>idf.py build</code></li>\n<li><code>idf.py -p /dev/ttyUSB0 flash</code> (check Port ID in <code>/dev/</code> before running the command)</li>\n<li><code>idf.py -p /dev/ttyUSB0 monitor</code></li>\n</ul>\n</li>\n</ol>\n<h3 id=\"results\">Results<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#results\"></a></h3>\n<p>Running <code>idf.py build</code> returns :</p>\n<pre class=\"language-shell\"><code class=\"language-shell\">Executing action: all <span class=\"token punctuation\">(</span>aliases: build<span class=\"token punctuation\">)</span>\nRunning ninja <span class=\"token keyword\">in</span> directory /home/tunn/esp/uart_async_rxtxtasks/build\nExecuting <span class=\"token string\">\"ninja all\"</span><span class=\"token punctuation\">..</span>.\n<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>/1<span class=\"token punctuation\">]</span> <span class=\"token builtin class-name\">cd</span> /home/tunn/esp/uart_async_rxtxtasks/build/bootloader/esp-idf/e<span class=\"token punctuation\">..</span>.000 /home/tunn/esp/uart_async_rxtxtasks/build/bootloader/bootloader.binBootloader binary size 0x6720 bytes. 0x8e0 bytes <span class=\"token punctuation\">(</span><span class=\"token number\">8</span>%<span class=\"token punctuation\">)</span> free.\n<span class=\"token punctuation\">[</span><span class=\"token number\">2</span>/7<span class=\"token punctuation\">]</span> Building C object esp-idf/main/CMakeFiles/__idf_main.dir/uart_async_rxtxtasks_main.c.obj/home/tunn/esp/uart_async_rxtxtasks/main/uart_async_rxtxtasks_main.c: In <span class=\"token keyword\">function</span> <span class=\"token string\">'tx_task'</span><span class=\"token builtin class-name\">:</span>\n/home/tunn/esp/uart_async_rxtxtasks/main/uart_async_rxtxtasks_main.c:98:19: warning: unused variable <span class=\"token string\">'nb_transmit'</span> <span class=\"token punctuation\">[</span>-Wunused-variable<span class=\"token punctuation\">]</span>\n   <span class=\"token number\">98</span> <span class=\"token operator\">|</span>         const int <span class=\"token assign-left variable\">nb_transmit</span><span class=\"token operator\">=</span>uart_write_bytes<span class=\"token punctuation\">(</span>UART_NUM_0, transmit, sizeof<span class=\"token punctuation\">(</span>transmit<span class=\"token punctuation\">))</span><span class=\"token punctuation\">;</span>\n      <span class=\"token operator\">|</span>                   ^~~~~~~~~~~\n/home/tunn/esp/uart_async_rxtxtasks/main/uart_async_rxtxtasks_main.c:93:19: warning: unused variable <span class=\"token string\">'nb_transmitH'</span> <span class=\"token punctuation\">[</span>-Wunused-variable<span class=\"token punctuation\">]</span>\n   <span class=\"token number\">93</span> <span class=\"token operator\">|</span>         const int <span class=\"token assign-left variable\">nb_transmitH</span><span class=\"token operator\">=</span>uart_write_bytes<span class=\"token punctuation\">(</span>UART_NUM_0, Header, sizeof<span class=\"token punctuation\">(</span>Header<span class=\"token punctuation\">))</span><span class=\"token punctuation\">;</span>\n      <span class=\"token operator\">|</span>                   ^~~~~~~~~~~~\n/home/tunn/esp/uart_async_rxtxtasks/main/uart_async_rxtxtasks_main.c: In <span class=\"token keyword\">function</span> <span class=\"token string\">'rx_task'</span><span class=\"token builtin class-name\">:</span>\n/home/tunn/esp/uart_async_rxtxtasks/main/uart_async_rxtxtasks_main.c:143:19: warning: unused variable <span class=\"token string\">'nb_bitM'</span> <span class=\"token punctuation\">[</span>-Wunused-variable<span class=\"token punctuation\">]</span>\n  <span class=\"token number\">143</span> <span class=\"token operator\">|</span>         const int <span class=\"token assign-left variable\">nb_bitM</span><span class=\"token operator\">=</span>uart_read_bytes<span class=\"token punctuation\">(</span>UART_NUM_0, message, sizeof<span class=\"token punctuation\">(</span>message_t<span class=\"token punctuation\">)</span>, <span class=\"token number\">1000</span> / portTICK_PERIOD_MS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token operator\">|</span>                   ^~~~~~~\n/home/tunn/esp/uart_async_rxtxtasks/main/uart_async_rxtxtasks_main.c: In <span class=\"token keyword\">function</span> <span class=\"token string\">'bank_task'</span><span class=\"token builtin class-name\">:</span>\n/home/tunn/esp/uart_async_rxtxtasks/main/uart_async_rxtxtasks_main.c:156:9: warning: unused variable <span class=\"token string\">'balance'</span> <span class=\"token punctuation\">[</span>-Wunused-variable<span class=\"token punctuation\">]</span>\n  <span class=\"token number\">156</span> <span class=\"token operator\">|</span>     int balance<span class=\"token punctuation\">;</span> //Solde <span class=\"token function\">du</span> compte\n      <span class=\"token operator\">|</span>         ^~~~~~~\n<span class=\"token punctuation\">[</span><span class=\"token number\">6</span>/7<span class=\"token punctuation\">]</span> Generating binary image from built executableesptool.py v4.5.dev0\nCreating esp32 image<span class=\"token punctuation\">..</span>.\nMerged <span class=\"token number\">2</span> ELF sections\nSuccessfully created esp32 image.\nGenerated /home/tunn/esp/uart_async_rxtxtasks/build/uart_async_rxtxtasks.bin\n<span class=\"token punctuation\">[</span><span class=\"token number\">7</span>/7<span class=\"token punctuation\">]</span> <span class=\"token builtin class-name\">cd</span> /home/tunn/esp/uart_async_rxtxtasks/build/esp-idf/esptool_py <span class=\"token operator\">&#x26;</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span>bin /home/tunn/esp/uart_async_rxtxtasks/build/uart_async_rxtxtasks.binuart_async_rxtxtasks.bin binary size 0x31b00 bytes. Smallest app partition is 0x100000 bytes. 0xce500 bytes <span class=\"token punctuation\">(</span><span class=\"token number\">81</span>%<span class=\"token punctuation\">)</span> free.\n\nProject build complete. To flash, run this command:\n/home/tunn/.espressif/python_env/idf5.1_py3.10_env/bin/python <span class=\"token punctuation\">..</span>/esp-idf/components/esptool_py/esptool/esptool.py -p <span class=\"token punctuation\">(</span>PORT<span class=\"token punctuation\">)</span> -b <span class=\"token number\">460800</span> --before default_reset --after hard_reset --chip esp32  write_flash --flash_mode dio --flash_size 2MB --flash_freq 40m 0x1000 build/bootloader/bootloader.bin 0x8000 build/partition_table/partition-table.bin 0x10000 build/uart_async_rxtxtasks.bin\nor run <span class=\"token string\">'idf.py -p (PORT) flash'</span>\n</code></pre>\n<p>Running <code>idf.py -p /dev/ttyUSB0 flash</code> returns:</p>\n<pre class=\"language-shell\"><code class=\"language-shell\">Executing action: flash\nRunning ninja <span class=\"token keyword\">in</span> directory /home/tunn/esp/uart_async_rxtxtasks/build\nExecuting <span class=\"token string\">\"ninja flash\"</span><span class=\"token punctuation\">..</span>.\n<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>/5<span class=\"token punctuation\">]</span> <span class=\"token builtin class-name\">cd</span> /home/tunn/esp/uart_async_rxtxtasks/build/esp-idf/esptool_py <span class=\"token operator\">&#x26;&#x26;</span> /home/tunn/.espressif/python_env/idf5.1_py3.10_env/bin/python /home/tunn/esp/esp-idf/components/partition_table/check_sizes.py --offset 0x8000 partition --type app /home/tunn/esp/uart_async_rxtxtasks/build/partition_table/partition-table.bin /home/tunn/esp/uart_async_rxtxtasks/build/uart_async_rxtxtasks.bin\nuart_async_rxtxtasks.bin binary size 0x31b00 bytes. Smallest app partition is 0x100000 bytes. 0xce500 bytes <span class=\"token punctuation\">(</span><span class=\"token number\">81</span>%<span class=\"token punctuation\">)</span> free.\n<span class=\"token punctuation\">[</span><span class=\"token number\">2</span>/5<span class=\"token punctuation\">]</span> Performing build step <span class=\"token keyword\">for</span> <span class=\"token string\">'bootloader'</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>/1<span class=\"token punctuation\">]</span> <span class=\"token builtin class-name\">cd</span> /home/tunn/esp/uart_async_rxtxtasks/build/bootloader/esp-idf/esptool_py <span class=\"token operator\">&#x26;&#x26;</span> /home/tunn/.espressif/python_env/idf5.1_py3.10_env/bin/python /home/tunn/esp/esp-idf/components/partition_table/check_sizes.py --offset 0x8000 bootloader 0x1000 /home/tunn/esp/uart_async_rxtxtasks/build/bootloader/bootloader.bin\nBootloader binary size 0x6720 bytes. 0x8e0 bytes <span class=\"token punctuation\">(</span><span class=\"token number\">8</span>%<span class=\"token punctuation\">)</span> free.\n<span class=\"token punctuation\">[</span><span class=\"token number\">2</span>/3<span class=\"token punctuation\">]</span> <span class=\"token builtin class-name\">cd</span> /home/tunn/esp/esp-idf/components/esptool_py <span class=\"token operator\">&#x26;&#x26;</span> /usr/bin/cmake -D <span class=\"token assign-left variable\">IDF_PATH</span><span class=\"token operator\">=</span>/home/tunn/esp/esp-idf -D <span class=\"token string\">\"SERIAL_TOOL=/home/tunn/.espressif/python_env/idf5.1_py3.10_env/bin/python;;/home/tunn/esp/esp-idf/components/esptool_py/esptool/esptool.py;--chip;esp32\"</span> -D <span class=\"token string\">\"SERIAL_TOOL_ARGS=--before=default_reset;--after=hard_reset;write_flash;@flash_args\"</span> -D <span class=\"token assign-left variable\">WORKING_DIRECTORY</span><span class=\"token operator\">=</span>/home/tunn/esp/uart_async_rxtxtasks/build -P /home/tunn/esp/esp-idf/components/esptool_py/run_serial_tool.cmake\nesptool esp32 -p /dev/ttyUSB0 -b <span class=\"token number\">460800</span> --before<span class=\"token operator\">=</span>default_reset --after<span class=\"token operator\">=</span>hard_reset write_flash --flash_mode dio --flash_freq 40m --flash_size 2MB 0x1000 bootloader/bootloader.bin 0x10000 uart_async_rxtxtasks.bin 0x8000 partition_table/partition-table.bin\nesptool.py v4.5.dev0\nSerial port /dev/ttyUSB0\nConnecting<span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span>.\nChip is ESP32-D0WDQ6 <span class=\"token punctuation\">(</span>revision v1.0<span class=\"token punctuation\">)</span>\nFeatures: WiFi, BT, Dual Core, 240MHz, VRef calibration <span class=\"token keyword\">in</span> efuse, Coding Scheme None\nCrystal is 26MHz\nMAC: <span class=\"token number\">84</span>:0d:8e:07:4c:fc\nUploading stub<span class=\"token punctuation\">..</span>.\nRunning stub<span class=\"token punctuation\">..</span>.\nStub running<span class=\"token punctuation\">..</span>.\nChanging baud rate to <span class=\"token number\">460800</span>\nChanged.\nConfiguring flash size<span class=\"token punctuation\">..</span>.\nFlash will be erased from 0x00001000 to 0x00007fff<span class=\"token punctuation\">..</span>.\nFlash will be erased from 0x00010000 to 0x00041fff<span class=\"token punctuation\">..</span>.\nFlash will be erased from 0x00008000 to 0x00008fff<span class=\"token punctuation\">..</span>.\nCompressed <span class=\"token number\">26400</span> bytes to <span class=\"token number\">16472</span><span class=\"token punctuation\">..</span>.\nWriting at 0x00001000<span class=\"token punctuation\">..</span>. <span class=\"token punctuation\">(</span><span class=\"token number\">50</span> %<span class=\"token punctuation\">)</span>\nWriting at 0x000076ac<span class=\"token punctuation\">..</span>. <span class=\"token punctuation\">(</span><span class=\"token number\">100</span> %<span class=\"token punctuation\">)</span>\nWrote <span class=\"token number\">26400</span> bytes <span class=\"token punctuation\">(</span><span class=\"token number\">16472</span> compressed<span class=\"token punctuation\">)</span> at 0x00001000 <span class=\"token keyword\">in</span> <span class=\"token number\">0.7</span> seconds <span class=\"token punctuation\">(</span>effective <span class=\"token number\">288.5</span> kbit/s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">..</span>.\nHash of data verified.\nCompressed <span class=\"token number\">203520</span> bytes to <span class=\"token number\">107510</span><span class=\"token punctuation\">..</span>.\nWriting at 0x00010000<span class=\"token punctuation\">..</span>. <span class=\"token punctuation\">(</span><span class=\"token number\">14</span> %<span class=\"token punctuation\">)</span>\nWriting at 0x0001ca42<span class=\"token punctuation\">..</span>. <span class=\"token punctuation\">(</span><span class=\"token number\">28</span> %<span class=\"token punctuation\">)</span>\nWriting at 0x0002230b<span class=\"token punctuation\">..</span>. <span class=\"token punctuation\">(</span><span class=\"token number\">42</span> %<span class=\"token punctuation\">)</span>\nWriting at 0x0002810b<span class=\"token punctuation\">..</span>. <span class=\"token punctuation\">(</span><span class=\"token number\">57</span> %<span class=\"token punctuation\">)</span>\nWriting at 0x0002e59c<span class=\"token punctuation\">..</span>. <span class=\"token punctuation\">(</span><span class=\"token number\">71</span> %<span class=\"token punctuation\">)</span>\nWriting at 0x00038b81<span class=\"token punctuation\">..</span>. <span class=\"token punctuation\">(</span><span class=\"token number\">85</span> %<span class=\"token punctuation\">)</span>\nWriting at 0x0003e481<span class=\"token punctuation\">..</span>. <span class=\"token punctuation\">(</span><span class=\"token number\">100</span> %<span class=\"token punctuation\">)</span>\nWrote <span class=\"token number\">203520</span> bytes <span class=\"token punctuation\">(</span><span class=\"token number\">107510</span> compressed<span class=\"token punctuation\">)</span> at 0x00010000 <span class=\"token keyword\">in</span> <span class=\"token number\">2.6</span> seconds <span class=\"token punctuation\">(</span>effective <span class=\"token number\">614.6</span> kbit/s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">..</span>.\nHash of data verified.\nCompressed <span class=\"token number\">3072</span> bytes to <span class=\"token number\">103</span><span class=\"token punctuation\">..</span>.\nWriting at 0x00008000<span class=\"token punctuation\">..</span>. <span class=\"token punctuation\">(</span><span class=\"token number\">100</span> %<span class=\"token punctuation\">)</span>\nWrote <span class=\"token number\">3072</span> bytes <span class=\"token punctuation\">(</span><span class=\"token number\">103</span> compressed<span class=\"token punctuation\">)</span> at 0x00008000 <span class=\"token keyword\">in</span> <span class=\"token number\">0.1</span> seconds <span class=\"token punctuation\">(</span>effective <span class=\"token number\">490.8</span> kbit/s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">..</span>.\nHash of data verified.\n\nLeaving<span class=\"token punctuation\">..</span>.\nHard resetting via RTS pin<span class=\"token punctuation\">..</span>.\nDone\n</code></pre>\n<p>Running <code>idf.py -p /dev/ttyUSB0 monitor</code> returns:</p>\n<pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span><span class=\"token punctuation\">..</span>.<span class=\"token punctuation\">]</span>\nHello world\nI <span class=\"token punctuation\">(</span><span class=\"token number\">46335</span><span class=\"token punctuation\">)</span> TX_TASK: Wrote <span class=\"token number\">13</span> bytes\n\n\n�<span class=\"token string\">'�?Hello worldI (48335) TX_TASK: Wrote 13 bytes\n\n\n�'</span>�?Hello worldI <span class=\"token punctuation\">(</span><span class=\"token number\">50335</span><span class=\"token punctuation\">)</span> TX_TASK: Wrote <span class=\"token number\">13</span> bytes\n</code></pre>\n<h3 id=\"our-mainc\">Our main.c<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#our-mainc\"></a></h3>\n<pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">/* UART asynchronous example, that uses separate RX and TX tasks\n\n   This example code is in the Public Domain (or CC0 licensed, at your option.)\n\n   Unless required by applicable law or agreed to in writing, this\n   software is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n   CONDITIONS OF ANY KIND, either express or implied.\n*/</span>\n\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"freertos/FreeRTOS.h\"</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"freertos/task.h\"</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"esp_system.h\"</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"esp_log.h\"</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"driver/uart.h\"</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"string.h\"</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"driver/gpio.h\"</span></span>\n\n\n<span class=\"token keyword\">static</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">int</span> RX_BUF_SIZE <span class=\"token operator\">=</span> <span class=\"token number\">1024</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">TXD_PIN</span> <span class=\"token expression\"><span class=\"token punctuation\">(</span>GPIO_NUM_1<span class=\"token punctuation\">)</span></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">RXD_PIN</span> <span class=\"token expression\"><span class=\"token punctuation\">(</span>GPIO_NUM_3<span class=\"token punctuation\">)</span></span></span>\n\n<span class=\"token comment\">//Declaration d une structure pour le message</span>\n<span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> \n<span class=\"token punctuation\">{</span>\n<span class=\"token class-name\">uint8_t</span> Type<span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">uint8_t</span>  Action<span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">uint8_t</span> RequestID<span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">uint8_t</span> PortID<span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">uint32_t</span> Amount<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token class-name\">message_t</span> <span class=\"token punctuation\">;</span>\n\n\n<span class=\"token comment\">//Declaration des queues</span>\n<span class=\"token keyword\">static</span> QueueHandle_t rx_queue <span class=\"token operator\">=</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> QueueHandle_t tx_queue <span class=\"token operator\">=</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//Declaration du HEADER pour verifier le bon etat de la communication</span>\n<span class=\"token keyword\">const</span> <span class=\"token class-name\">uint8_t</span> HEADER<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token number\">0xCA</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFE</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xCA</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xFE</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n\n\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token class-name\">uart_config_t</span> uart_config <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token punctuation\">.</span>baud_rate <span class=\"token operator\">=</span> <span class=\"token number\">115200</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">.</span>data_bits <span class=\"token operator\">=</span> UART_DATA_8_BITS<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">.</span>parity <span class=\"token operator\">=</span> UART_PARITY_DISABLE<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">.</span>stop_bits <span class=\"token operator\">=</span> UART_STOP_BITS_1<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">.</span>flow_ctrl <span class=\"token operator\">=</span> UART_HW_FLOWCTRL_DISABLE<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">.</span>source_clk <span class=\"token operator\">=</span> UART_SCLK_DEFAULT<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// We won't use a buffer for sending data.</span>\n    <span class=\"token function\">uart_driver_install</span><span class=\"token punctuation\">(</span>UART_NUM_0<span class=\"token punctuation\">,</span> RX_BUF_SIZE <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">uart_param_config</span><span class=\"token punctuation\">(</span>UART_NUM_0<span class=\"token punctuation\">,</span> <span class=\"token operator\">&#x26;</span>uart_config<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">uart_set_pin</span><span class=\"token punctuation\">(</span>UART_NUM_0<span class=\"token punctuation\">,</span> TXD_PIN<span class=\"token punctuation\">,</span> RXD_PIN<span class=\"token punctuation\">,</span> UART_PIN_NO_CHANGE<span class=\"token punctuation\">,</span> UART_PIN_NO_CHANGE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  \n    <span class=\"token comment\">//Initialisation des queues</span>\n     rx_queue <span class=\"token operator\">=</span> <span class=\"token function\">xQueueCreate</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n     tx_queue<span class=\"token operator\">=</span><span class=\"token function\">xQueueCreate</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n\n\n\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">sendData</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span> logName<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span> data<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token keyword\">int</span> len <span class=\"token operator\">=</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> <span class=\"token keyword\">int</span> txBytes <span class=\"token operator\">=</span> <span class=\"token function\">uart_write_bytes</span><span class=\"token punctuation\">(</span>UART_NUM_0<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">,</span> len<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">ESP_LOGI</span><span class=\"token punctuation\">(</span>logName<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Wrote %d bytes\\n\\n\"</span><span class=\"token punctuation\">,</span> txBytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> txBytes<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">tx_task</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>arg<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">static</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>TX_TASK_TAG <span class=\"token operator\">=</span> <span class=\"token string\">\"TX_TASK\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">////Allocation dynamique de la memoire pour les buffers de messages</span>\n     <span class=\"token class-name\">uint32_t</span> <span class=\"token operator\">*</span>transmit<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">message_t</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n      <span class=\"token class-name\">uint8_t</span> <span class=\"token operator\">*</span>Header<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint8_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token operator\">*</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint8_t</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n    <span class=\"token function\">esp_log_level_set</span><span class=\"token punctuation\">(</span>TX_TASK_TAG<span class=\"token punctuation\">,</span> ESP_LOG_INFO<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    \t<span class=\"token comment\">//Stockage du premier message sur la queue dans le buffer avant envoi</span>\n    \t <span class=\"token function\">xQueueReceive</span><span class=\"token punctuation\">(</span>tx_queue<span class=\"token punctuation\">,</span>transmit<span class=\"token punctuation\">,</span><span class=\"token number\">1000</span> <span class=\"token operator\">/</span> portTICK_PERIOD_MS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    \t \n    \t <span class=\"token comment\">//Envoi du header</span>\n    \t<span class=\"token keyword\">const</span> <span class=\"token keyword\">int</span> nb_transmitH<span class=\"token operator\">=</span><span class=\"token function\">uart_write_bytes</span><span class=\"token punctuation\">(</span>UART_NUM_0<span class=\"token punctuation\">,</span> Header<span class=\"token punctuation\">,</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>Header<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    \t\n    \t<span class=\"token function\">vTaskDelay</span><span class=\"token punctuation\">(</span><span class=\"token number\">2000</span> <span class=\"token operator\">/</span> portTICK_PERIOD_MS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    \t\n    \t<span class=\"token comment\">//Envoi du message</span>\n        <span class=\"token keyword\">const</span> <span class=\"token keyword\">int</span> nb_transmit<span class=\"token operator\">=</span><span class=\"token function\">uart_write_bytes</span><span class=\"token punctuation\">(</span>UART_NUM_0<span class=\"token punctuation\">,</span> transmit<span class=\"token punctuation\">,</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>transmit<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">vTaskDelay</span><span class=\"token punctuation\">(</span><span class=\"token number\">2000</span> <span class=\"token operator\">/</span> portTICK_PERIOD_MS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token comment\">//Liberation des buffers</span>\n    <span class=\"token function\">free</span><span class=\"token punctuation\">(</span>transmit<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">free</span><span class=\"token punctuation\">(</span>Header<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">rx_task</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>arg<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\t\n    <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">static</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>RX_TASK_TAG <span class=\"token operator\">=</span> <span class=\"token string\">\"RX_TASK\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">esp_log_level_set</span><span class=\"token punctuation\">(</span>RX_TASK_TAG<span class=\"token punctuation\">,</span> ESP_LOG_INFO<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">//Allocation dynamique de la memoire pour les buffers de messages</span>\n    <span class=\"token class-name\">uint8_t</span><span class=\"token operator\">*</span> data <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">uint8_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span>RX_BUF_SIZE<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">uint8_t</span> <span class=\"token operator\">*</span>R_Head<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint8_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token operator\">*</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint8_t</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n    <span class=\"token class-name\">uint32_t</span> <span class=\"token operator\">*</span>message<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token operator\">*</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n    \n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> <span class=\"token keyword\">int</span> rxBytes <span class=\"token operator\">=</span> <span class=\"token function\">uart_read_bytes</span><span class=\"token punctuation\">(</span>UART_NUM_0<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">,</span> RX_BUF_SIZE<span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span> <span class=\"token operator\">/</span> portTICK_PERIOD_MS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>rxBytes <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            data<span class=\"token punctuation\">[</span>rxBytes<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">ESP_LOGI</span><span class=\"token punctuation\">(</span>RX_TASK_TAG<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Read %d bytes: '%s'\\n\\n\"</span><span class=\"token punctuation\">,</span> rxBytes<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">ESP_LOG_BUFFER_HEXDUMP</span><span class=\"token punctuation\">(</span>RX_TASK_TAG<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">,</span> rxBytes<span class=\"token punctuation\">,</span> ESP_LOG_INFO<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        \n        <span class=\"token comment\">//Reception du header</span>\n        <span class=\"token keyword\">const</span> <span class=\"token keyword\">int</span> nb_bitH<span class=\"token operator\">=</span><span class=\"token function\">uart_read_bytes</span><span class=\"token punctuation\">(</span>UART_NUM_0<span class=\"token punctuation\">,</span> R_Head<span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token operator\">*</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint8_t</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span> <span class=\"token operator\">/</span> portTICK_PERIOD_MS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        \n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>nb_bitH<span class=\"token operator\">==</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n        \t<span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&#x3C;</span>nb_bitH<span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n        \t<span class=\"token punctuation\">{</span>        \t\n        \t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>R_Head<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token operator\">!=</span>HEADER<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n        \t\t\t<span class=\"token punctuation\">{</span>\n        \t\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Wrong Header ! Communication Failed !\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        \t\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\t\n        \t\t\t<span class=\"token punctuation\">}</span>\n        \t        \t        \t\t\n        \t<span class=\"token punctuation\">}</span>\n        \t       \n        <span class=\"token punctuation\">}</span>\n        \n        <span class=\"token comment\">//Reception du message et stockage dans la queue        </span>\n        <span class=\"token keyword\">const</span> <span class=\"token keyword\">int</span> nb_bitM<span class=\"token operator\">=</span><span class=\"token function\">uart_read_bytes</span><span class=\"token punctuation\">(</span>UART_NUM_0<span class=\"token punctuation\">,</span> message<span class=\"token punctuation\">,</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">message_t</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span> <span class=\"token operator\">/</span> portTICK_PERIOD_MS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">xQueueSend</span><span class=\"token punctuation\">(</span>rx_queue<span class=\"token punctuation\">,</span>message<span class=\"token punctuation\">,</span><span class=\"token number\">1000</span> <span class=\"token operator\">/</span> portTICK_PERIOD_MS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n      \n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// Liberation des buffers</span>\n    <span class=\"token function\">free</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">free</span><span class=\"token punctuation\">(</span>R_Head<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">free</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n\n<span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">bank_task</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>arg<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">int</span> balance<span class=\"token punctuation\">;</span> <span class=\"token comment\">//Solde du compte</span>\n    <span class=\"token keyword\">static</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>TX_TASK_TAG <span class=\"token operator\">=</span> <span class=\"token string\">\"TX_TASK\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">esp_log_level_set</span><span class=\"token punctuation\">(</span>TX_TASK_TAG<span class=\"token punctuation\">,</span> ESP_LOG_INFO<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">sendData</span><span class=\"token punctuation\">(</span>TX_TASK_TAG<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Hello world\\n\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">vTaskDelay</span><span class=\"token punctuation\">(</span><span class=\"token number\">2000</span> <span class=\"token operator\">/</span> portTICK_PERIOD_MS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">app_main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">xTaskCreate</span><span class=\"token punctuation\">(</span>rx_task<span class=\"token punctuation\">,</span> <span class=\"token string\">\"uart_rx_task\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1024</span><span class=\"token operator\">*</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> configMAX_PRIORITIES<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">xTaskCreate</span><span class=\"token punctuation\">(</span>tx_task<span class=\"token punctuation\">,</span> <span class=\"token string\">\"uart_tx_task\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1024</span><span class=\"token operator\">*</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> configMAX_PRIORITIES<span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">xTaskCreate</span><span class=\"token punctuation\">(</span>bank_task<span class=\"token punctuation\">,</span> <span class=\"token string\">\"bank_task\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1024</span><span class=\"token operator\">*</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> configMAX_PRIORITIES<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<h2 id=\"our-python-code\">Our Python Code<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#our-python-code\"></a></h2>\n<pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># -------------------------------------------- #</span>\n<span class=\"token comment\"># Class Client                                 #</span>\n<span class=\"token comment\"># Tasks:                                       #</span>\n<span class=\"token comment\"># - emit serial messages to the ESP card       #</span>\n<span class=\"token comment\"># - receive serial messages from the ESP card  #</span>\n<span class=\"token comment\"># -------------------------------------------- #</span>\n\n<span class=\"token comment\"># This module encapsulates the access for the serial port.</span>\n<span class=\"token keyword\">import</span> serial\n<span class=\"token comment\"># This module converts between Python values and C structs</span>\n<span class=\"token comment\"># represented as Python bytes objects.</span>\n<span class=\"token keyword\">from</span> struct <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">client</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># initializing values and properties of objects</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> st_type<span class=\"token punctuation\">,</span> st_cid<span class=\"token punctuation\">,</span> st_rid<span class=\"token punctuation\">,</span> st_operation<span class=\"token punctuation\">,</span> st_ammount<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>st_type <span class=\"token operator\">=</span> st_type              <span class=\"token comment\"># 0 or 1 w.r.t. being resp. REQUEST or RESPONSE</span>\n        self<span class=\"token punctuation\">.</span>st_cid <span class=\"token operator\">=</span> st_cid                <span class=\"token comment\"># 0 .. 255 identification number for the client</span>\n        self<span class=\"token punctuation\">.</span>st_rid <span class=\"token operator\">=</span> st_rid                <span class=\"token comment\"># 0 .. 255 identification number for the request</span>\n        self<span class=\"token punctuation\">.</span>st_operation <span class=\"token operator\">=</span> st_operation    <span class=\"token comment\"># 0 or 1 w.r.t. being resp. withdraw or deposit</span>\n        self<span class=\"token punctuation\">.</span>st_ammount <span class=\"token operator\">=</span> st_ammount        <span class=\"token comment\"># positive integer for the ammount </span>\n    \n    <span class=\"token comment\"># method structurizing the message with struct.pack</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">structurer</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">bytes</span><span class=\"token punctuation\">:</span>\n        st <span class=\"token operator\">=</span> struct<span class=\"token punctuation\">.</span>pack<span class=\"token punctuation\">(</span><span class=\"token string\">\"&#x3C;IIIQ\"</span><span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>st_type<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>st_cid<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>st_rid<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>st_operation<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>st_ammount<span class=\"token punctuation\">)</span> \n        <span class=\"token keyword\">return</span> st\n    \n    <span class=\"token comment\"># method sending a message throw the serial port</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">send_message</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\n        ser <span class=\"token operator\">=</span> serial<span class=\"token punctuation\">.</span>Serial<span class=\"token punctuation\">(</span><span class=\"token string\">'/dev/ttyUSB0'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># open serial port</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>ser<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span>                     <span class=\"token comment\"># check which port was really used</span>\n        ser<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>structurer<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\"># write a string</span>\n        ser<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>                         <span class=\"token comment\"># close port</span>\n</code></pre>\n<hr>\n<strong>Backlinks</strong>\n<ul>\n<li><a href=\"/UT3-AURO-2223-S10-Dendron/notes/zlr2s0g64dtr3njuzx1iylh\">SATR - Systèmes et Architectures Temps Réels</a></li>\n</ul>","noteIndex":{"id":"wn8PE1RhG0znK1alrGFYv","title":"Portail Digital du M2 AURO 2022/2023 de RKA","desc":"","updated":1669033598588,"created":1631901573363,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault"},"contentHash":"4d5454b71088c3c74fdb20ab3ed32dab","links":[],"anchors":{"idée":{"type":"header","text":"Idée","value":"idée","line":11,"column":0,"depth":1},"liens-utiles":{"type":"header","text":"Liens utiles","value":"liens-utiles","line":17,"column":0,"depth":1},"remerciement":{"type":"header","text":"Remerciement","value":"remerciement","line":28,"column":0,"depth":1},"contact":{"type":"header","text":"Contact","value":"contact","line":36,"column":0,"depth":1}},"children":["wmc6wolqmlygiqlfcwihsso","43j78t90ywskb5ji2dl1dv6","wifhrlf5o1cm74d5nvmwtmd","g54kxj2u0t1wl4x6uo6vgbt","90wm5tdnz2dnqs3098ttvor"],"parent":null,"data":{},"body":"\n> **Avertissement:**\nCette page peut contenir des fautes ! Envoyez-moi un message sur [`#UT3-AURO-M2-2223-Request:matrix.org`](https://matrix.to/#/#UT3-AURO-M2-2223-Request:matrix.org) si vous en trouvez, merci.\n\n# Idée\n\nCe projet a pour but de regrouper mes notes de cours en utilisant les outils offerts par [Dendron](dendron.so) pour structurer et hiérarchiser l'information.\n\nDe cette façon, ce portail devient un \"one-stop-shop\" pour accéder et/ou retrouver les connaissances acquises durant le master.\n\n# Liens utiles\n\nPour plus d'informations:\n- [Lien officiel du Master AURO de l'Université Paul Sabatier](https://www.univ-tlse3.fr/master-parcours-automatique-et-robotique-auro)\n- [Lien vers la page moodle des cours](https://moodle.univ-tlse3.fr/course/index.php?categoryid=1269)\n- [Dendron Official Website](dendron.so)\n- [Dendron Wiki](https://wiki.dendron.so/)\n- [Dendron's Discord](https://discord.com/invite/xrKTUStHNZ)\n\n\n\n# Remerciement\n\nUn grand merci à GEA pour avoir mis à disposition les scans de ses notes !\n\nJe tiens aussi à remercier mes enseignants pour m'autoriser à prendre en photo les tableaux.\n\nLastly, a big thank you to everyone in [Dendron](dendron.so)'s team and the community for all their support.\n\n# Contact\n\nUn salon [Element](https://element.io/) est mis à disposition des lecteurs pour toutes questions/sugesstions ou pour faire remonter des erreurs/typos.\n\n\n[`#UT3-AURO-M2-2223-Request:matrix.org`](https://matrix.to/#/#UT3-AURO-M2-2223-Request:matrix.org)\n\n---\n\n> This website has been generated using [Dendron](dendron.so) and [GitHub Actions](https://github.com/features/actions).\n\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":false,"leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2,"vaultSelectionModeOnCreate":"smart"}},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"randomNote":{},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":"vault"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"maxPreviewsCached":10,"maxNoteLength":204800,"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"enableUserTags":true,"enableHashTags":true,"dendronVersion":"0.95.0","enableEditorDecorations":true,"enableFullHierarchyNoteTitle":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false,"enableFrontmatterTags":true,"enableHashesForFMTags":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Dendron","description":"Personal knowledge space"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"lookup","enableMermaid":true,"assetsPrefix":"/UT3-AURO-2223-S10-Dendron","siteUrl":"https://tunnark.github.io","duplicateNoteBehavior":{"action":"useVault","payload":["vault"]},"theme":"dark","siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true}